
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jaxquantum.org/reference/jaxquantum/index.html">
      
      
        <link rel="prev" href="../../documentation/advanced/enr.html">
      
      
        <link rel="next" href="circuits/index.html">
      
      
        
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>jaxquantum - jaxquantum</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jaxquantum" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="jaxquantum" class="md-header__button md-logo" aria-label="jaxquantum" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jaxquantum
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              jaxquantum
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="purple" data-md-color-accent="deep-purple"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/EQuS/jaxquantum" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    jaxquantum
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../documentation/index.html" class="md-tabs__link">
        
  
  
    
  
  Documentation

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="index.html" class="md-tabs__link">
          
  
  
  Code Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="jaxquantum" class="md-nav__button md-logo" aria-label="jaxquantum" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    jaxquantum
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EQuS/jaxquantum" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    jaxquantum
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/community.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Community
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/citation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Citation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../documentation/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/getting_started/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/getting_started/qarray.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Qarray
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/getting_started/sharp_bits.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Sharp Bits ðŸ”ª
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/tutorials/circuits.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Circuits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/tutorials/bosonic_codes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bosonic Codes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/advanced/enr.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Excitation Number Restricted Basis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link md-nav__link--active">
              
  
  
  <span class="md-ellipsis">
    
  
    jaxquantum
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    jaxquantum
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="circuits/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    circuits
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    circuits
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="circuits/circuits.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    circuits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="circuits/constants.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    constants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="circuits/gates.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="circuits/library/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    library
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_4" id="__nav_3_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    library
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="circuits/library/generic.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    generic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="circuits/library/oscillator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    oscillator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="circuits/library/qubit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    qubit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="circuits/simulate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    simulate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="codes/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    codes
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    codes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="codes/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="codes/binomial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    binomial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="codes/cat.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="codes/gkp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gkp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="codes/mode.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="codes/qubit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    qubit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="core/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    core
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/cfunctions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cfunctions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/conversions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    conversions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/dims.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dims
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/measurements.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    measurements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/operators.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/qarray.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    qarray
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/qp_distributions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    qp_distributions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/settings.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/solvers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    solvers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core/visualization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    visualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="devices/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    devices
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    devices
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="devices/analysis/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    analysis
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4_1" id="__nav_3_1_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    analysis
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/analysis/sweeps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sweeps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="devices/base/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4_2" id="__nav_3_1_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    base
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/base/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/base/system.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    system
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="devices/common/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    common
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4_3" id="__nav_3_1_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    common
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/common/utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="devices/superconducting/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    superconducting
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4_4" id="__nav_3_1_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    superconducting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/ats.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/drive.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    drive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/flux_base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    flux_base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/fluxonium.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    fluxonium
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/ideal_qubit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ideal_qubit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/kno.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kno
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/resonator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    resonator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/snail.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    snail
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/transmon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    transmon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices/superconducting/tunable_transmon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tunable_transmon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="utils/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/hermgauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hermgauss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/units.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    units
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jaxquantum" class="md-nav__link">
    <span class="md-ellipsis">
      
        jaxquantum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.Qarray" class="md-nav__link">
    <span class="md-ellipsis">
      
        Qarray
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Qarray">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.__deepcopy__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __deepcopy__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.__truediv__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __truediv__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.from_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.from_list" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_list
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.reshape_bdims" class="md-nav__link">
    <span class="md-ellipsis">
      
        reshape_bdims
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.reshape_qdims" class="md-nav__link">
    <span class="md-ellipsis">
      
        reshape_qdims
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.Qarray.resize" class="md-nav__link">
    <span class="md-ellipsis">
      
        resize
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.QuantumStateTomography" class="md-nav__link">
    <span class="md-ellipsis">
      
        QuantumStateTomography
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QuantumStateTomography">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.QuantumStateTomography.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.QuantumStateTomography.quantum_state_tomography_direct" class="md-nav__link">
    <span class="md-ellipsis">
      
        quantum_state_tomography_direct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.QuantumStateTomography.quantum_state_tomography_mle" class="md-nav__link">
    <span class="md-ellipsis">
      
        quantum_state_tomography_mle
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.Ec_to_inv_pF" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ec_to_inv_pF
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.as_series" class="md-nav__link">
    <span class="md-ellipsis">
      
        as_series
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="as_series">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.as_series--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.as_series--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.basis" class="md-nav__link">
    <span class="md-ellipsis">
      
        basis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.basis_like" class="md-nav__link">
    <span class="md-ellipsis">
      
        basis_like
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.cf_wigner" class="md-nav__link">
    <span class="md-ellipsis">
      
        cf_wigner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cf_wigner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.cf_wigner--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.cf_wigner--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.coherent" class="md-nav__link">
    <span class="md-ellipsis">
      
        coherent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.collapse" class="md-nav__link">
    <span class="md-ellipsis">
      
        collapse
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.comb" class="md-nav__link">
    <span class="md-ellipsis">
      
        comb
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="comb">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.comb--todo-replace-with-jspspecialcomb-once-issue-is-closed" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO: replace with jsp.special.comb once issue is closed:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.comb--of-items-to-choose" class="md-nav__link">
    <span class="md-ellipsis">
      
        of items to choose
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.concatenate" class="md-nav__link">
    <span class="md-ellipsis">
      
        concatenate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.cosm" class="md-nav__link">
    <span class="md-ellipsis">
      
        cosm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.cosm_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        cosm_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.create" class="md-nav__link">
    <span class="md-ellipsis">
      
        create
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.dag" class="md-nav__link">
    <span class="md-ellipsis">
      
        dag
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.dag_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        dag_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.destroy" class="md-nav__link">
    <span class="md-ellipsis">
      
        destroy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.displace" class="md-nav__link">
    <span class="md-ellipsis">
      
        displace
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.eigenenergies" class="md-nav__link">
    <span class="md-ellipsis">
      
        eigenenergies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.eigenstates" class="md-nav__link">
    <span class="md-ellipsis">
      
        eigenstates
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.expm" class="md-nav__link">
    <span class="md-ellipsis">
      
        expm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.expm_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        expm_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.extract_dims" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_dims
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.fidelity" class="md-nav__link">
    <span class="md-ellipsis">
      
        fidelity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.hadamard" class="md-nav__link">
    <span class="md-ellipsis">
      
        hadamard
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.hermcompanion" class="md-nav__link">
    <span class="md-ellipsis">
      
        hermcompanion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hermcompanion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.hermcompanion--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.hermcompanion--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.identity_like" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity_like
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.inductance_to_inductive_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        inductance_to_inductive_energy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.inductive_energy_to_inductance" class="md-nav__link">
    <span class="md-ellipsis">
      
        inductive_energy_to_inductance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.inv_pF_to_Ec" class="md-nav__link">
    <span class="md-ellipsis">
      
        inv_pF_to_Ec
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.is_dm_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_dm_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.jnp2jqt" class="md-nav__link">
    <span class="md-ellipsis">
      
        jnp2jqt
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.jqt2qt" class="md-nav__link">
    <span class="md-ellipsis">
      
        jqt2qt
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.ket2dm" class="md-nav__link">
    <span class="md-ellipsis">
      
        ket2dm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.mesolve" class="md-nav__link">
    <span class="md-ellipsis">
      
        mesolve
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.multi_mode_basis_set" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_mode_basis_set
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.n_thermal" class="md-nav__link">
    <span class="md-ellipsis">
      
        n_thermal
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.num" class="md-nav__link">
    <span class="md-ellipsis">
      
        num
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.overlap" class="md-nav__link">
    <span class="md-ellipsis">
      
        overlap
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.plot_cf" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_cf
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.plot_cf_wigner" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_cf_wigner
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.plot_qfunc" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_qfunc
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.plot_qp" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_qp
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.plot_wigner" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_wigner
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.powm" class="md-nav__link">
    <span class="md-ellipsis">
      
        powm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.powm_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        powm_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.propagator" class="md-nav__link">
    <span class="md-ellipsis">
      
        propagator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.ptrace" class="md-nav__link">
    <span class="md-ellipsis">
      
        ptrace
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.qfunc" class="md-nav__link">
    <span class="md-ellipsis">
      
        qfunc
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="qfunc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.qfunc--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.qfunc--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.qt2jqt" class="md-nav__link">
    <span class="md-ellipsis">
      
        qt2jqt
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.qubit_rotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        qubit_rotation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.sesolve" class="md-nav__link">
    <span class="md-ellipsis">
      
        sesolve
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.set_precision" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_precision
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.sigmam" class="md-nav__link">
    <span class="md-ellipsis">
      
        sigmam
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.sigmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        sigmap
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.sigmax" class="md-nav__link">
    <span class="md-ellipsis">
      
        sigmax
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.sigmay" class="md-nav__link">
    <span class="md-ellipsis">
      
        sigmay
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.sigmaz" class="md-nav__link">
    <span class="md-ellipsis">
      
        sigmaz
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.sinm_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        sinm_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.solve" class="md-nav__link">
    <span class="md-ellipsis">
      
        solve
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.squeeze" class="md-nav__link">
    <span class="md-ellipsis">
      
        squeeze
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.tensor" class="md-nav__link">
    <span class="md-ellipsis">
      
        tensor
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.tensor_basis" class="md-nav__link">
    <span class="md-ellipsis">
      
        tensor_basis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.thermal_dm" class="md-nav__link">
    <span class="md-ellipsis">
      
        thermal_dm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.tr" class="md-nav__link">
    <span class="md-ellipsis">
      
        tr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.trace" class="md-nav__link">
    <span class="md-ellipsis">
      
        trace
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.transpose" class="md-nav__link">
    <span class="md-ellipsis">
      
        transpose
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.unit" class="md-nav__link">
    <span class="md-ellipsis">
      
        unit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxquantum.wigner" class="md-nav__link">
    <span class="md-ellipsis">
      
        wigner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wigner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaxquantum.wigner--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.wigner--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jaxquantum.wigner--references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>jaxquantum</h1>

<div class="doc doc-object doc-module">



<a id="jaxquantum"></a>
    <div class="doc doc-contents first">

        <p>jaxquantum</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="jaxquantum.Qarray" class="doc doc-heading">
            <code>Qarray</code>


</h2>


    <div class="doc doc-contents ">










              <details class="mkdocstrings-source">
                <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@struct</span><span class="o">.</span><span class="n">dataclass</span>  <span class="c1"># this allows us to send in and return Qarray from jitted functions</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Qarray</span><span class="p">:</span>
    <span class="n">_data</span><span class="p">:</span> <span class="n">Array</span>
    <span class="n">_qdims</span><span class="p">:</span> <span class="n">Qdims</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">pytree_node</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_bdims</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">pytree_node</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Initialization ----</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bdims</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Step 1: Prepare data ----</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bdims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># ----</span>

        <span class="c1"># Step 2: Prepare dimensions ----</span>
        <span class="k">if</span> <span class="n">bdims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bdims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">dims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],),</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="c1"># This handles the case where only the hilbert space dimensions are sent in.</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dims</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dims</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dims</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dims</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">check_dims</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">bdims</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="n">qdims</span> <span class="o">=</span> <span class="n">Qdims</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>

        <span class="c1"># NOTE: Constantly tidying up on Qarray creation might be a bit overkill.</span>
        <span class="c1"># It increases the compilation time, but only very slightly</span>
        <span class="c1"># increased the runtime of the jit compiled function.</span>
        <span class="c1"># We could instead use this tidy_up where we think we need it.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">tidy_up</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">SETTINGS</span><span class="p">[</span><span class="s2">&quot;auto_tidyup_atol&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">qdims</span><span class="p">,</span> <span class="n">bdims</span><span class="p">)</span>

    <span class="c1"># ----</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">qarr_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Qarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Qarray from a list of Qarrays.&quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">qarr</span> <span class="ow">in</span> <span class="n">qarr_list</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">((),</span> <span class="p">())</span>
            <span class="n">bdims</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="n">qarr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span>
            <span class="n">bdims</span> <span class="o">=</span> <span class="n">qarr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bdims</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">dims</span> <span class="o">==</span> <span class="n">dims</span> <span class="ow">and</span> <span class="n">qarr</span><span class="o">.</span><span class="n">bdims</span> <span class="o">==</span> <span class="n">bdims</span> <span class="k">for</span> <span class="n">qarr</span> <span class="ow">in</span> <span class="n">qarr_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All Qarrays in the list must have the same dimensions.&quot;</span><span class="p">)</span>

        <span class="n">bdims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">),)</span> <span class="o">+</span> <span class="n">bdims</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">bdims</span><span class="o">=</span><span class="n">bdims</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">qarr_arr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Qarray from a nested list of Qarrays.</span>

<span class="sd">        Args:</span>
<span class="sd">            qarr_arr (list): nested list of Qarrays</span>

<span class="sd">        Returns:</span>
<span class="sd">            Qarray: Qarray object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarr_arr</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">qarr_arr</span>

        <span class="n">bdims</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">lvl</span> <span class="o">=</span> <span class="n">qarr_arr</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lvl</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="n">bdims</span> <span class="o">=</span> <span class="n">bdims</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lvl</span><span class="p">),)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lvl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">lvl</span> <span class="o">=</span> <span class="n">lvl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">flat</span><span class="p">(</span><span class="n">lis</span><span class="p">):</span>
            <span class="n">flatList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">flatList</span> <span class="o">+=</span> <span class="n">flat</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">flatList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">flatList</span>

        <span class="n">qarr_list</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span><span class="n">qarr_arr</span><span class="p">)</span>
        <span class="n">qarr</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">)</span>
        <span class="n">qarr</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">reshape_bdims</span><span class="p">(</span><span class="o">*</span><span class="n">bdims</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">qarr</span>

    <span class="c1"># Properties ----</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">qtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span><span class="o">.</span><span class="n">qtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">dtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span><span class="o">.</span><span class="n">dims</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bdims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bdims</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">qdims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">space_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">qtype</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Qtypes</span><span class="o">.</span><span class="n">oper</span><span class="p">,</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">ket</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">bra</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: not reached for some reason</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported qtype.&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shaped_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdims</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_batched</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdims</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdims</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot index a non-batched Qarray.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reshape_bdims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reshape the batch dimensions of the Qarray.&quot;&quot;&quot;</span>
        <span class="n">new_bdims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">prod</span><span class="p">(</span><span class="n">new_bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_shape</span> <span class="o">=</span> <span class="n">new_bdims</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_shape</span> <span class="o">=</span> <span class="n">new_bdims</span> <span class="o">+</span> <span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_shape</span><span class="p">),</span>
            <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
            <span class="n">bdims</span><span class="o">=</span><span class="n">new_bdims</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">space_to_qdims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">space_dims</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">space_dims</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">qtype</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Qtypes</span><span class="o">.</span><span class="n">oper</span><span class="p">,</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">ket</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">space_dims</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">space_dims</span><span class="p">))]))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">bra</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">space_dims</span><span class="p">))]),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">space_dims</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported qtype for space_to_qdims conversion.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reshape_qdims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reshape the quantum dimensions of the Qarray.</span>

<span class="sd">        Note that this does not take in qdims but rather the new Hilbert space dimensions.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: new Hilbert dimensions for the Qarray.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Qarray: reshaped Qarray.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_space_dims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">current_space_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_dims</span>
        <span class="k">assert</span> <span class="n">prod</span><span class="p">(</span><span class="n">new_space_dims</span><span class="p">)</span> <span class="o">==</span> <span class="n">prod</span><span class="p">(</span><span class="n">current_space_dims</span><span class="p">)</span>

        <span class="n">new_qdims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_to_qdims</span><span class="p">(</span><span class="n">new_space_dims</span><span class="p">)</span>
        <span class="n">new_bdims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdims</span>

        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">new_qdims</span><span class="p">,</span> <span class="n">bdims</span><span class="o">=</span><span class="n">new_bdims</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resize the Qarray to a new shape.</span>

<span class="sd">        TODO: review and maybe deprecate this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Length of the Qarray.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdims</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot get length of a non-batched Qarray.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot calculate equality of a Qarray with a non-Qarray.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdims</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">bdims</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="c1"># ----</span>

    <span class="c1"># Elementary Math ----</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="n">_qdims_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span> <span class="o">@</span> <span class="n">other</span><span class="o">.</span><span class="n">_qdims</span>
        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">@</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">dims</span><span class="o">=</span><span class="n">_qdims_new</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># NOTE: not possible to reach this.</span>
    <span class="c1"># def __rmatmul__(self, other):</span>
    <span class="c1">#     if not isinstance(other, Qarray):</span>
    <span class="c1">#         return NotImplemented</span>

    <span class="c1">#     _qdims_new = other._qdims @ self._qdims</span>
    <span class="c1">#     return Qarray.create(</span>
    <span class="c1">#         other.data @ self.data,</span>
    <span class="c1">#         dims=_qdims_new.dims,</span>
    <span class="c1">#     )</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__matmul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">robust_isscalar</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># not a scalar</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">other</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># NOTE: not possible to reach this.</span>
        <span class="c1"># if isinstance(other, Qarray):</span>
        <span class="c1">#     return self.__rmatmul__(other)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For Qarray&#39;s, this only really makes sense in the context of division by a scalar.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot divide a Qarray by another Qarray.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Dimensions are incompatible: &quot;</span>
                    <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot; and &quot;</span>
                    <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">robust_isscalar</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">robust_isscalar</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># not a scalar</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">other</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
                <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Dimensions are incompatible: &quot;</span>
                    <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot; and &quot;</span>
                    <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">robust_isscalar</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">robust_isscalar</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># not a scalar</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">other</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
                <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__sub__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">()</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">return</span> <span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__rxor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">return</span> <span class="n">tensor</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">return</span> <span class="n">powm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="c1"># ----</span>

    <span class="c1"># String Representation ----</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_str_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;Quantum array: dims = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">),</span>
                <span class="s2">&quot;bdims = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdims</span><span class="p">),</span>
                <span class="s2">&quot;shape = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span>
                <span class="s2">&quot;type = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qtype</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_header</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Qarray data =</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the header of the Qarray.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_header</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>

    <span class="c1"># ----</span>

    <span class="c1"># Utilities ----</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># return Qarray.create(deepcopy(self.data), dims=self.dims)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Need to override this when defininig __getattr__.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">Qarray</span><span class="p">(</span>
            <span class="n">_data</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">),</span>
            <span class="n">_qdims</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">),</span>
            <span class="n">_bdims</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bdims</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;__&quot;</span> <span class="o">==</span> <span class="n">method_name</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
            <span class="c1"># NOTE: we return NotImplemented for binary special methods logic in python, plus things like __jax_array__</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="bp">NotImplemented</span>

        <span class="n">modules</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="p">,</span> <span class="n">jsp</span><span class="p">,</span> <span class="n">jsp</span><span class="o">.</span><span class="n">linalg</span><span class="p">]</span>

        <span class="n">method_f</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">mod</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="n">method_f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">method_f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">method_f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Method </span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2"> does not exist. No backup method found in </span><span class="si">{</span><span class="n">modules</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">method_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">res</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">res</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">func</span>

    <span class="c1"># ----</span>

    <span class="c1"># Conversions / Reshaping ----</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ket2dm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_dm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">oper</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">ket</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">bra</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_ket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">to_ket</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">keep_only_diag_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">keep_only_diag_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># ----</span>

    <span class="c1"># Math Functions ----</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">unit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">expm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">powm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">powm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cosm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cosm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sinm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sinm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ptrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ptrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indx</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eigenstates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">eigenstates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eigenenergies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">eigenenergies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collapse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">collapse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="jaxquantum.Qarray.header" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">header</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Print the header of the Qarray.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.__deepcopy__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__deepcopy__</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Need to override this when defininig <strong>getattr</strong>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Need to override this when defininig __getattr__.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="p">(</span>
        <span class="n">_data</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">),</span>
        <span class="n">_qdims</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_qdims</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">),</span>
        <span class="n">_bdims</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bdims</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Length of the Qarray.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Length of the Qarray.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdims</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot get length of a non-batched Qarray.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.__truediv__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__truediv__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>For Qarray's, this only really makes sense in the context of division by a scalar.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;For Qarray&#39;s, this only really makes sense in the context of division by a scalar.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot divide a Qarray by another Qarray.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.from_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_array</span><span class="p">(</span><span class="n">qarr_arr</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a Qarray from a nested list of Qarrays.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr_arr</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nested list of Qarrays</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Qarray</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">qarr_arr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Qarray from a nested list of Qarrays.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr_arr (list): nested list of Qarrays</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray: Qarray object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qarr_arr</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">qarr_arr</span>

    <span class="n">bdims</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">lvl</span> <span class="o">=</span> <span class="n">qarr_arr</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lvl</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="n">bdims</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lvl</span><span class="p">),)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lvl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lvl</span> <span class="o">=</span> <span class="n">lvl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">flat</span><span class="p">(</span><span class="n">lis</span><span class="p">):</span>
        <span class="n">flatList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">flatList</span> <span class="o">+=</span> <span class="n">flat</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flatList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flatList</span>

    <span class="n">qarr_list</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span><span class="n">qarr_arr</span><span class="p">)</span>
    <span class="n">qarr</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">)</span>
    <span class="n">qarr</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">reshape_bdims</span><span class="p">(</span><span class="o">*</span><span class="n">bdims</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">qarr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.from_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_list</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a Qarray from a list of Qarrays.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">qarr_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Qarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Qarray from a list of Qarrays.&quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">qarr</span> <span class="ow">in</span> <span class="n">qarr_list</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="p">((),</span> <span class="p">())</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="n">qarr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="n">qarr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bdims</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">dims</span> <span class="o">==</span> <span class="n">dims</span> <span class="ow">and</span> <span class="n">qarr</span><span class="o">.</span><span class="n">bdims</span> <span class="o">==</span> <span class="n">bdims</span> <span class="k">for</span> <span class="n">qarr</span> <span class="ow">in</span> <span class="n">qarr_list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All Qarrays in the list must have the same dimensions.&quot;</span><span class="p">)</span>

    <span class="n">bdims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">),)</span> <span class="o">+</span> <span class="n">bdims</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">bdims</span><span class="o">=</span><span class="n">bdims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.reshape_bdims" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reshape_bdims</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reshape the batch dimensions of the Qarray.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reshape_bdims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reshape the batch dimensions of the Qarray.&quot;&quot;&quot;</span>
    <span class="n">new_bdims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">prod</span><span class="p">(</span><span class="n">new_bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_shape</span> <span class="o">=</span> <span class="n">new_bdims</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_shape</span> <span class="o">=</span> <span class="n">new_bdims</span> <span class="o">+</span> <span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_shape</span><span class="p">),</span>
        <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
        <span class="n">bdims</span><span class="o">=</span><span class="n">new_bdims</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.reshape_qdims" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reshape_qdims</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reshape the quantum dimensions of the Qarray.</p>
<p>Note that this does not take in qdims but rather the new Hilbert space dimensions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>new Hilbert dimensions for the Qarray.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Qarray</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reshaped Qarray.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reshape_qdims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reshape the quantum dimensions of the Qarray.</span>

<span class="sd">    Note that this does not take in qdims but rather the new Hilbert space dimensions.</span>

<span class="sd">    Args:</span>
<span class="sd">        *args: new Hilbert dimensions for the Qarray.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray: reshaped Qarray.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">new_space_dims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">current_space_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_dims</span>
    <span class="k">assert</span> <span class="n">prod</span><span class="p">(</span><span class="n">new_space_dims</span><span class="p">)</span> <span class="o">==</span> <span class="n">prod</span><span class="p">(</span><span class="n">current_space_dims</span><span class="p">)</span>

    <span class="n">new_qdims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_to_qdims</span><span class="p">(</span><span class="n">new_space_dims</span><span class="p">)</span>
    <span class="n">new_bdims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdims</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">new_qdims</span><span class="p">,</span> <span class="n">bdims</span><span class="o">=</span><span class="n">new_bdims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.Qarray.resize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resize</span><span class="p">(</span><span class="n">new_shape</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resize the Qarray to a new shape.</p>
<p>TODO: review and maybe deprecate this method.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resize the Qarray to a new shape.</span>

<span class="sd">    TODO: review and maybe deprecate this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="jaxquantum.QuantumStateTomography" class="doc doc-heading">
            <code>QuantumStateTomography</code>


</h2>


    <div class="doc doc-contents ">










              <details class="mkdocstrings-source">
                <summary>Source code in <code>jaxquantum/core/measurements.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">QuantumStateTomography</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rho_guess</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span>
        <span class="n">measurement_basis</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span>
        <span class="n">measurement_results</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">complete_basis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Qarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">true_rho</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Qarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reconstruct a quantum state from measurement results using quantum state tomography.</span>
<span class="sd">        The tomography can be performed either by direct inversion or by maximum likelihood estimation.</span>

<span class="sd">        Args:</span>
<span class="sd">            rho_guess (Qarray): The initial guess for the quantum state.</span>
<span class="sd">            measurement_basis (Qarray): The basis in which measurements are performed.</span>
<span class="sd">            measurement_results (jnp.ndarray): The results of the measurements.</span>
<span class="sd">            complete_basis (Optional[Qarray]): The complete basis for state </span>
<span class="sd">            reconstruction used when using direct inversion. </span>
<span class="sd">            Defaults to the measurement basis if not provided.</span>
<span class="sd">            true_rho (Optional[Qarray]): The true quantum state, if known.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho_guess</span> <span class="o">=</span> <span class="n">rho_guess</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measurement_basis</span> <span class="o">=</span> <span class="n">measurement_basis</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measurement_results</span> <span class="o">=</span> <span class="n">measurement_results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complete_basis</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">complete_basis</span><span class="o">.</span><span class="n">data</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">complete_basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">measurement_basis</span><span class="o">.</span><span class="n">data</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">true_rho</span> <span class="o">=</span> <span class="n">true_rho</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MLETomographyResult</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">quantum_state_tomography_mle</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">L1_reg_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5e-3</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MLETomographyResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform quantum state tomography using maximum likelihood </span>
<span class="sd">        estimation (MLE).</span>

<span class="sd">        This method reconstructs the quantum state from measurement results </span>
<span class="sd">        by optimizing</span>
<span class="sd">        a likelihood function using gradient descent. The optimization </span>
<span class="sd">        ensures the </span>
<span class="sd">        resulting density matrix is positive semi-definite with trace 1.</span>

<span class="sd">        Args:</span>
<span class="sd">            L1_reg_strength (float, optional): Strength of L1 </span>
<span class="sd">            regularization. Defaults to 0.0.</span>
<span class="sd">            epochs (int, optional): Number of optimization iterations. </span>
<span class="sd">            Defaults to 10000.</span>
<span class="sd">            lr (float, optional): Learning rate for the Adam optimizer. </span>
<span class="sd">            Defaults to 5e-3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            MLETomographyResult: Named tuple containing:</span>
<span class="sd">                - rho: Reconstructed quantum state as Qarray</span>
<span class="sd">                - params_history: List of parameter values during optimization</span>
<span class="sd">                - loss_history: List of loss values during optimization</span>
<span class="sd">                - grads_history: List of gradient values during optimization</span>
<span class="sd">                - infidelity_history: List of infidelities if true_rho was </span>
<span class="sd">                provided, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_guess</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>

        <span class="c1"># Initialize parameters from the initial guess for the density matrix</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">_parametrize_density_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho_guess</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
        <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="n">compute_infidelity_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_rho</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="c1"># Provide a dummy array if no true_rho is available. It won&#39;t be used.</span>
        <span class="n">true_rho_data_or_dummy</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">true_rho</span><span class="o">.</span><span class="n">data</span>
            <span class="k">if</span> <span class="n">compute_infidelity_flag</span>
            <span class="k">else</span> <span class="n">jnp</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">final_carry</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="n">_run_tomography_scan</span><span class="p">(</span>
            <span class="n">initial_params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">initial_opt_state</span><span class="o">=</span><span class="n">opt_state</span><span class="p">,</span>
            <span class="n">true_rho_data</span><span class="o">=</span><span class="n">true_rho_data_or_dummy</span><span class="p">,</span>
            <span class="n">measurement_basis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_basis</span><span class="p">,</span>
            <span class="n">measurement_results</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_results</span><span class="p">,</span>
            <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
            <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
            <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
            <span class="n">compute_infidelity</span><span class="o">=</span><span class="n">compute_infidelity_flag</span><span class="p">,</span>
            <span class="n">L1_reg_strength</span><span class="o">=</span><span class="n">L1_reg_strength</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">final_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">final_carry</span>

        <span class="n">rho</span> <span class="o">=</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">_reconstruct_density_matrix</span><span class="p">(</span><span class="n">final_params</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="n">MLETomographyResult</span><span class="p">(</span>
            <span class="n">rho</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span>
            <span class="n">params_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">],</span>
            <span class="n">loss_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">],</span>
            <span class="n">grads_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;grads&quot;</span><span class="p">],</span>
            <span class="n">infidelity_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;infidelity&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">compute_infidelity_flag</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">quantum_state_tomography_direct</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform quantum state tomography using direct inversion.</span>

<span class="sd">        This method reconstructs the quantum state from measurement results by </span>
<span class="sd">        directly solving a system of linear equations. The method assumes that</span>
<span class="sd">        the measurement basis is complete and the measurement results are </span>
<span class="sd">        noise-free.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Qarray: Reconstructed quantum state.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="c1"># Compute overlaps of measurement and complete operator bases</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijk,ljk-&gt;il&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">complete_basis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement_basis</span><span class="p">)</span>
        <span class="c1"># Solve the linear system to find the coefficients</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement_results</span><span class="p">)</span>
        <span class="c1"># Reconstruct the density matrix</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;i, ijk-&gt;jk&quot;</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">complete_basis</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;No results to plot. Run quantum_state_tomography_mle first.&quot;</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="o">.</span><span class="n">infidelity_history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="o">.</span><span class="n">loss_history</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Epoch&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mathcal</span><span class="si">{L}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="o">.</span><span class="n">infidelity_history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="o">.</span><span class="n">infidelity_history</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$1-</span><span class="se">\\</span><span class="s2">mathcal</span><span class="si">{F}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="jaxquantum.QuantumStateTomography.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">rho_guess</span><span class="p">,</span> <span class="n">measurement_basis</span><span class="p">,</span> <span class="n">measurement_results</span><span class="p">,</span> <span class="n">complete_basis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">true_rho</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reconstruct a quantum state from measurement results using quantum state tomography.
The tomography can be performed either by direct inversion or by maximum likelihood estimation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rho_guess</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial guess for the quantum state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measurement_basis</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The basis in which measurements are performed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measurement_results</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The results of the measurements.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complete_basis</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The complete basis for state </p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>true_rho</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The true quantum state, if known.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/measurements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">rho_guess</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span>
    <span class="n">measurement_basis</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span>
    <span class="n">measurement_results</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">complete_basis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Qarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">true_rho</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Qarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reconstruct a quantum state from measurement results using quantum state tomography.</span>
<span class="sd">    The tomography can be performed either by direct inversion or by maximum likelihood estimation.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho_guess (Qarray): The initial guess for the quantum state.</span>
<span class="sd">        measurement_basis (Qarray): The basis in which measurements are performed.</span>
<span class="sd">        measurement_results (jnp.ndarray): The results of the measurements.</span>
<span class="sd">        complete_basis (Optional[Qarray]): The complete basis for state </span>
<span class="sd">        reconstruction used when using direct inversion. </span>
<span class="sd">        Defaults to the measurement basis if not provided.</span>
<span class="sd">        true_rho (Optional[Qarray]): The true quantum state, if known.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rho_guess</span> <span class="o">=</span> <span class="n">rho_guess</span><span class="o">.</span><span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">measurement_basis</span> <span class="o">=</span> <span class="n">measurement_basis</span><span class="o">.</span><span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">measurement_results</span> <span class="o">=</span> <span class="n">measurement_results</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">complete_basis</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">complete_basis</span><span class="o">.</span><span class="n">data</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">complete_basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">measurement_basis</span><span class="o">.</span><span class="n">data</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">true_rho</span> <span class="o">=</span> <span class="n">true_rho</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.QuantumStateTomography.quantum_state_tomography_direct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">quantum_state_tomography_direct</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform quantum state tomography using direct inversion.</p>
<p>This method reconstructs the quantum state from measurement results by 
directly solving a system of linear equations. The method assumes that
the measurement basis is complete and the measurement results are 
noise-free.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Qarray</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reconstructed quantum state.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/measurements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">quantum_state_tomography_direct</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform quantum state tomography using direct inversion.</span>

<span class="sd">    This method reconstructs the quantum state from measurement results by </span>
<span class="sd">    directly solving a system of linear equations. The method assumes that</span>
<span class="sd">    the measurement basis is complete and the measurement results are </span>
<span class="sd">    noise-free.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray: Reconstructed quantum state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="c1"># Compute overlaps of measurement and complete operator bases</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijk,ljk-&gt;il&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">complete_basis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement_basis</span><span class="p">)</span>
    <span class="c1"># Solve the linear system to find the coefficients</span>
    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurement_results</span><span class="p">)</span>
    <span class="c1"># Reconstruct the density matrix</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;i, ijk-&gt;jk&quot;</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">complete_basis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jaxquantum.QuantumStateTomography.quantum_state_tomography_mle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">quantum_state_tomography_mle</span><span class="p">(</span><span class="n">L1_reg_strength</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform quantum state tomography using maximum likelihood 
estimation (MLE).</p>
<p>This method reconstructs the quantum state from measurement results 
by optimizing
a likelihood function using gradient descent. The optimization 
ensures the 
resulting density matrix is positive semi-definite with trace 1.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>L1_reg_strength</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strength of L1 </p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epochs</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of optimization iterations. </p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lr</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for the Adam optimizer. </p>
              </div>
            </td>
            <td>
                  <code>0.005</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>MLETomographyResult</code></td>            <td>
                  <code><span title="jaxquantum.core.measurements.MLETomographyResult">MLETomographyResult</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Named tuple containing:
- rho: Reconstructed quantum state as Qarray
- params_history: List of parameter values during optimization
- loss_history: List of loss values during optimization
- grads_history: List of gradient values during optimization
- infidelity_history: List of infidelities if true_rho was 
provided, None otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/measurements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">quantum_state_tomography_mle</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">L1_reg_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MLETomographyResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform quantum state tomography using maximum likelihood </span>
<span class="sd">    estimation (MLE).</span>

<span class="sd">    This method reconstructs the quantum state from measurement results </span>
<span class="sd">    by optimizing</span>
<span class="sd">    a likelihood function using gradient descent. The optimization </span>
<span class="sd">    ensures the </span>
<span class="sd">    resulting density matrix is positive semi-definite with trace 1.</span>

<span class="sd">    Args:</span>
<span class="sd">        L1_reg_strength (float, optional): Strength of L1 </span>
<span class="sd">        regularization. Defaults to 0.0.</span>
<span class="sd">        epochs (int, optional): Number of optimization iterations. </span>
<span class="sd">        Defaults to 10000.</span>
<span class="sd">        lr (float, optional): Learning rate for the Adam optimizer. </span>
<span class="sd">        Defaults to 5e-3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        MLETomographyResult: Named tuple containing:</span>
<span class="sd">            - rho: Reconstructed quantum state as Qarray</span>
<span class="sd">            - params_history: List of parameter values during optimization</span>
<span class="sd">            - loss_history: List of loss values during optimization</span>
<span class="sd">            - grads_history: List of gradient values during optimization</span>
<span class="sd">            - infidelity_history: List of infidelities if true_rho was </span>
<span class="sd">            provided, None otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_guess</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>

    <span class="c1"># Initialize parameters from the initial guess for the density matrix</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">_parametrize_density_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho_guess</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
    <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="n">compute_infidelity_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_rho</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="c1"># Provide a dummy array if no true_rho is available. It won&#39;t be used.</span>
    <span class="n">true_rho_data_or_dummy</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">true_rho</span><span class="o">.</span><span class="n">data</span>
        <span class="k">if</span> <span class="n">compute_infidelity_flag</span>
        <span class="k">else</span> <span class="n">jnp</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">final_carry</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="n">_run_tomography_scan</span><span class="p">(</span>
        <span class="n">initial_params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">initial_opt_state</span><span class="o">=</span><span class="n">opt_state</span><span class="p">,</span>
        <span class="n">true_rho_data</span><span class="o">=</span><span class="n">true_rho_data_or_dummy</span><span class="p">,</span>
        <span class="n">measurement_basis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_basis</span><span class="p">,</span>
        <span class="n">measurement_results</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_results</span><span class="p">,</span>
        <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
        <span class="n">compute_infidelity</span><span class="o">=</span><span class="n">compute_infidelity_flag</span><span class="p">,</span>
        <span class="n">L1_reg_strength</span><span class="o">=</span><span class="n">L1_reg_strength</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">final_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">final_carry</span>

    <span class="n">rho</span> <span class="o">=</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">_reconstruct_density_matrix</span><span class="p">(</span><span class="n">final_params</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="n">MLETomographyResult</span><span class="p">(</span>
        <span class="n">rho</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span>
        <span class="n">params_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">],</span>
        <span class="n">loss_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">],</span>
        <span class="n">grads_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;grads&quot;</span><span class="p">],</span>
        <span class="n">infidelity_history</span><span class="o">=</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;infidelity&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">compute_infidelity_flag</span>
        <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="jaxquantum.Ec_to_inv_pF" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Ec_to_inv_pF</span><span class="p">(</span><span class="n">Ec</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>GHz -&gt; 1/picoFarad</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/units.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Ec_to_inv_pF</span><span class="p">(</span><span class="n">Ec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GHz -&gt; 1/picoFarad</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">joule</span> <span class="o">=</span> <span class="n">GHz_to_joule</span><span class="p">(</span><span class="n">Ec</span><span class="p">)</span>
    <span class="n">Gjoule</span> <span class="o">=</span> <span class="n">joule</span> <span class="o">/</span> <span class="mf">1e9</span>
    <span class="n">inv_nFarad</span> <span class="o">=</span> <span class="n">Gjoule</span> <span class="o">/</span> <span class="p">((</span><span class="n">constants</span><span class="o">.</span><span class="n">e</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">inv_nFarad</span> <span class="o">*</span> <span class="mf">1e-3</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.as_series" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_series</span><span class="p">(</span><span class="o">*</span><span class="n">arrs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return arguments as a list of 1-d arrays.</p>
<p>The returned list contains array(s) of dtype double, complex double, or
object.  A 1-d argument of shape <code>(N,)</code> is parsed into <code>N</code> arrays of
size one; a 2-d argument of shape <code>(M,N)</code> is parsed into <code>M</code> arrays
of size <code>N</code> (i.e., is "parsed by row"); and a higher dimensional array
raises a Value Error if it is not first reshaped into either a 1-d or 2-d
array.</p>
<h4 id="jaxquantum.as_series--parameters">Parameters</h4>
<p>arrs : array_like
    1- or 2-d array_like
trim : boolean, optional
    When True, trailing zeros are removed from the inputs.
    When False, the inputs are passed through intact.</p>
<h4 id="jaxquantum.as_series--returns">Returns</h4>
<p>a1, a2,... : 1-D arrays
    A copy of the input data as 1-d arrays.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/hermgauss.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">as_series</span><span class="p">(</span><span class="o">*</span><span class="n">arrs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return arguments as a list of 1-d arrays.</span>

<span class="sd">    The returned list contains array(s) of dtype double, complex double, or</span>
<span class="sd">    object.  A 1-d argument of shape ``(N,)`` is parsed into ``N`` arrays of</span>
<span class="sd">    size one; a 2-d argument of shape ``(M,N)`` is parsed into ``M`` arrays</span>
<span class="sd">    of size ``N`` (i.e., is &quot;parsed by row&quot;); and a higher dimensional array</span>
<span class="sd">    raises a Value Error if it is not first reshaped into either a 1-d or 2-d</span>
<span class="sd">    array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arrs : array_like</span>
<span class="sd">        1- or 2-d array_like</span>
<span class="sd">    trim : boolean, optional</span>
<span class="sd">        When True, trailing zeros are removed from the inputs.</span>
<span class="sd">        When False, the inputs are passed through intact.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a1, a2,... : 1-D arrays</span>
<span class="sd">        A copy of the input data as 1-d arrays.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arrays</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">)</span>
    <span class="n">arrays</span> <span class="o">=</span> <span class="n">promote_dtypes_inexact</span><span class="p">(</span><span class="o">*</span><span class="n">arrays</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.basis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a |k&gt; (i.e. fock state) ket in a specified Hilbert Space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert space dimension</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fock number</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fock State |k&gt;</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">basis</span><span class="p">(</span><span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a |k&gt; (i.e. fock state) ket in a specified Hilbert Space.</span>

<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert space dimension</span>
<span class="sd">        k: fock number</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fock State |k&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">one_hot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.basis_like" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basis_like</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">ks</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a |k&gt; (i.e. fock state) ket with the same space dims as A.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state or operator.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fock number.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fock State |k&gt; with the same space dims as A.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">basis_like</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">ks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a |k&gt; (i.e. fock state) ket with the same space dims as A.</span>

<span class="sd">    Args:</span>
<span class="sd">        A: state or operator.</span>
<span class="sd">        k: fock number.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fock State |k&gt; with the same space dims as A.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">space_dims</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">space_dims</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">space_dims</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ks</span><span class="p">),</span> <span class="s2">&quot;len(ks) must be equal to len(space_dims)&quot;</span>

    <span class="n">kets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ks</span><span class="p">):</span>
        <span class="n">kets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="n">space_dims</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">k</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tensor</span><span class="p">(</span><span class="o">*</span><span class="n">kets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.cf_wigner" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cf_wigner</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Wigner function for a state vector or density matrix at points
<code>xvec + i * yvec</code>.</p>
<h4 id="jaxquantum.cf_wigner--parameters">Parameters</h4>


<details class="state-" open>
  <summary>Qarray</summary>
  <p>A state vector or density matrix.</p>
</details>

<details class="xvec-" open>
  <summary>array_like</summary>
  <p>x-coordinates at which to calculate the Wigner function.</p>
</details>

<details class="yvec-" open>
  <summary>array_like</summary>
  <p>y-coordinates at which to calculate the Wigner function.</p>
</details>        <h4 id="jaxquantum.cf_wigner--returns">Returns</h4>


<details class="w-" open>
  <summary>array</summary>
  <p>Values representing the Wigner function calculated over the specified
range [xvec,yvec].</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/cfunctions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cf_wigner</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wigner function for a state vector or density matrix at points</span>
<span class="sd">    `xvec + i * yvec`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    state : Qarray</span>
<span class="sd">        A state vector or density matrix.</span>

<span class="sd">    xvec : array_like</span>
<span class="sd">        x-coordinates at which to calculate the Wigner function.</span>

<span class="sd">    yvec : array_like</span>
<span class="sd">        y-coordinates at which to calculate the Wigner function.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    W : array</span>
<span class="sd">        Values representing the Wigner function calculated over the specified</span>
<span class="sd">        range [xvec,yvec].</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">displacement</span> <span class="o">=</span> <span class="n">jqt</span><span class="o">.</span><span class="n">displace</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="n">vmapped_overlap</span> <span class="o">=</span> <span class="p">[</span><span class="n">vmap</span><span class="p">(</span><span class="n">vmap</span><span class="p">(</span><span class="n">jqt</span><span class="o">.</span><span class="n">overlap</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">psi</span><span class="o">.</span><span class="n">bdims</span><span class="p">:</span>
        <span class="n">vmapped_overlap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vmap</span><span class="p">(</span><span class="n">vmapped_overlap</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)))</span>

    <span class="n">cf</span> <span class="o">=</span> <span class="n">vmapped_overlap</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">](</span><span class="n">psi</span><span class="p">,</span> <span class="n">displacement</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.coherent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coherent</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Î±</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Coherent state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert Space Size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Î±</code>
            </td>
            <td>
                  <code><span title="complex">complex</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coherent state amplitude.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="return" open>
  <summary>Return</summary>
  <p>Coherent state |Î±âŸ©.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">coherent</span><span class="p">(</span><span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Î±</span><span class="p">:</span> <span class="nb">complex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coherent state.</span>

<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert Space Size.</span>
<span class="sd">        Î±: coherent state amplitude.</span>

<span class="sd">    Return:</span>
<span class="sd">        Coherent state |Î±âŸ©.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">displace</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Î±</span><span class="p">)</span> <span class="o">@</span> <span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.collapse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collapse</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Collapse the Qarray.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Collapsed quantum array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">collapse</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collapse the Qarray.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array array</span>

<span class="sd">    Returns:</span>
<span class="sd">        Collapsed quantum array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">qarr</span>

        <span class="n">batch_axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">bdims</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">batch_axes</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">qarr</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.comb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>NCk</p>
<h3 id="jaxquantum.comb--todo-replace-with-jspspecialcomb-once-issue-is-closed">TODO: replace with jsp.special.comb once issue is closed:</h3>
<p>https://github.com/google/jax/issues/9709</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>total items</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <h3 id="jaxquantum.comb--of-items-to-choose">of items to choose</h3>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>NCk</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>N choose k</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NCk</span>

<span class="sd">    #TODO: replace with jsp.special.comb once issue is closed:</span>
<span class="sd">    https://github.com/google/jax/issues/9709</span>

<span class="sd">    Args:</span>
<span class="sd">        N: total items</span>
<span class="sd">        k: # of items to choose</span>

<span class="sd">    Returns:</span>
<span class="sd">        NCk: N choose k</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">N_plus_1</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">one</span><span class="p">)</span>
    <span class="n">k_plus_1</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">one</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
        <span class="n">lax</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
            <span class="n">gammaln</span><span class="p">(</span><span class="n">N_plus_1</span><span class="p">),</span> <span class="n">lax</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">k_plus_1</span><span class="p">),</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">lax</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">N_plus_1</span><span class="p">,</span> <span class="n">k</span><span class="p">)))</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.concatenate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">concatenate</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Concatenate a list of Qarrays along a specified axis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr_list</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Qarrays to concatenate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axis</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Axis along which to concatenate. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Qarray</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Concatenated Qarray.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">concatenate</span><span class="p">(</span><span class="n">qarr_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Qarray</span><span class="p">],</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Concatenate a list of Qarrays along a specified axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr_list (List[Qarray]): List of Qarrays to concatenate.</span>
<span class="sd">        axis (int): Axis along which to concatenate. Default is 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray: Concatenated Qarray.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">non_empty_qarr_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">qarr</span> <span class="k">for</span> <span class="n">qarr</span> <span class="ow">in</span> <span class="n">qarr_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_empty_qarr_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">from_list</span><span class="p">([])</span>

    <span class="n">concatenated_data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">[</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">qarr</span> <span class="ow">in</span> <span class="n">non_empty_qarr_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span>
    <span class="p">)</span>

    <span class="n">dims</span> <span class="o">=</span> <span class="n">non_empty_qarr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">concatenated_data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.cosm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cosm</span><span class="p">(</span><span class="n">qarr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Matrix cosine wrapper.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix cosine</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cosm</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix cosine wrapper.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>

<span class="sd">    Returns:</span>
<span class="sd">        matrix cosine</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">dims</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">cosm_data</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.cosm_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cosm_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Matrix cosine wrapper.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix cosine</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cosm_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix cosine wrapper.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matrix cosine</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">expm_data</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="n">expm_data</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>creation operator</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert space size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>creation operator in Hilber Space of size N</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;creation operator</span>

<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert space size</span>

<span class="sd">    Returns:</span>
<span class="sd">        creation operator in Hilber Space of size N</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.dag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dag</span><span class="p">(</span><span class="n">qarr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Conjugate transpose.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>conjugate transpose of qarr</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dag</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Conjugate transpose.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>

<span class="sd">    Returns:</span>
<span class="sd">        conjugate transpose of qarr</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">dims</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">dag_data</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.dag_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dag_data</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Conjugate transpose.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arr</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>operator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>conjugate of op, and transposes last two axes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dag_data</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Conjugate transpose.</span>

<span class="sd">    Args:</span>
<span class="sd">        arr: operator</span>

<span class="sd">    Returns:</span>
<span class="sd">        conjugate of op, and transposes last two axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: revisit this case...</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span>
    <span class="p">)</span>  <span class="c1"># transposes last two axes, good for batching</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.destroy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">destroy</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>annihilation operator</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert space size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>annilation operator in Hilber Space of size N</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">destroy</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;annihilation operator</span>

<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert space size</span>

<span class="sd">    Returns:</span>
<span class="sd">        annilation operator in Hilber Space of size N</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.displace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">displace</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Î±</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Displacement operator</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert Space Size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Î±</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space displacement</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Displace operator D(Î±)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">displace</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Î±</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displacement operator</span>

<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert Space Size</span>
<span class="sd">        Î±: Phase space displacement</span>

<span class="sd">    Returns:</span>
<span class="sd">        Displace operator D(Î±)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Î±</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">Î±</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.eigenenergies" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eigenenergies</span><span class="p">(</span><span class="n">qarr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Eigenvalues of a quantum array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>eigenvalues</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">eigenenergies</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eigenvalues of a quantum array.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>

<span class="sd">    Returns:</span>
<span class="sd">        eigenvalues</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">evals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">evals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.eigenstates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eigenstates</span><span class="p">(</span><span class="n">qarr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Eigenstates of a quantum array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>eigenvalues and eigenstates</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">eigenstates</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eigenstates of a quantum array.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>

<span class="sd">    Returns:</span>
<span class="sd">        eigenvalues and eigenstates</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">idxs_sorted</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">dims</span> <span class="o">=</span> <span class="n">ket_from_op_dims</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>

    <span class="n">evals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">idxs_sorted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">evecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">evecs</span><span class="p">,</span> <span class="n">idxs_sorted</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># numpy returns [batch, :, i] as the i-th eigenvector</span>
    <span class="c1"># we want [batch, i, :] as the i-th eigenvector</span>
    <span class="n">evecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">evecs</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">evecs</span> <span class="o">=</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">evecs</span><span class="p">,</span>
        <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span>
        <span class="n">bdims</span><span class="o">=</span><span class="n">evecs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.expm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expm</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Matrix exponential wrapper.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix exponential</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expm</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix exponential wrapper.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matrix exponential</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">dims</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">expm_data</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.expm_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expm_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Matrix exponential wrapper.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix exponential</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expm_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix exponential wrapper.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matrix exponential</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jsp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.extract_dims" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_dims</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Extract dims from a JAX array or Qarray.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arr</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JAX array or Qarray.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="jaxquantum.core.dims.DIMS_TYPE">DIMS_TYPE</span>, <span title="typing.List">List</span>[<span title="int">int</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray dims.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray dims.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/conversions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_dims</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">dims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">DIMS_TYPE</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract dims from a JAX array or Qarray.</span>

<span class="sd">    Args:</span>
<span class="sd">        arr: JAX array or Qarray.</span>
<span class="sd">        dims: Qarray dims.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray dims.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Number</span><span class="p">):</span>
        <span class="n">is_op</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">is_op</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dims</span><span class="p">,</span> <span class="n">dims</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dims</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims</span><span class="p">)]</span>  <span class="c1"># defaults to ket</span>
    <span class="k">return</span> <span class="n">dims</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.fidelity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fidelity</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">force_positivity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fidelity between two states.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rho</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sigma</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force_positivity</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>force the states to be positive semidefinite</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fidelity between rho and sigma.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/measurements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fidelity</span><span class="p">(</span><span class="n">rho</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">force_positivity</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fidelity between two states.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho: state.</span>
<span class="sd">        sigma: state.</span>
<span class="sd">        force_positivity: force the states to be positive semidefinite</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fidelity between rho and sigma.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span>

    <span class="n">sqrt_rho</span> <span class="o">=</span> <span class="n">powm</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">clip_eigvals</span><span class="o">=</span><span class="n">force_positivity</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(((</span><span class="n">powm</span><span class="p">(</span><span class="n">sqrt_rho</span> <span class="o">@</span> <span class="n">sigma</span> <span class="o">@</span> <span class="n">sqrt_rho</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
                           <span class="n">clip_eigvals</span><span class="o">=</span><span class="n">force_positivity</span><span class="p">))</span><span class="o">.</span><span class="n">tr</span><span class="p">())</span>
                    <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.hadamard" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hadamard</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>H</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>H</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hadamard gate</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hadamard</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;H</span>

<span class="sd">    Returns:</span>
<span class="sd">        H: Hadamard gate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.hermcompanion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hermcompanion</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return the scaled companion matrix of c.</p>
<p>The basis polynomials are scaled so that the companion matrix is
symmetric when <code>c</code> is an Hermite basis polynomial. This provides
better eigenvalue estimates than the unscaled case and for basis
polynomials the eigenvalues are guaranteed to be real if
<code>jax.numpy.linalg.eigvalsh</code> is used to obtain them.</p>
<h4 id="jaxquantum.hermcompanion--parameters">Parameters</h4>
<p>c : array_like
    1-D array of Hermite series coefficients ordered from low to high
    degree.</p>
<h4 id="jaxquantum.hermcompanion--returns">Returns</h4>
<p>mat : ndarray
    Scaled companion matrix of dimensions (deg, deg).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/hermgauss.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hermcompanion</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the scaled companion matrix of c.</span>

<span class="sd">    The basis polynomials are scaled so that the companion matrix is</span>
<span class="sd">    symmetric when `c` is an Hermite basis polynomial. This provides</span>
<span class="sd">    better eigenvalue estimates than the unscaled case and for basis</span>
<span class="sd">    polynomials the eigenvalues are guaranteed to be real if</span>
<span class="sd">    `jax.numpy.linalg.eigvalsh` is used to obtain them.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    c : array_like</span>
<span class="sd">        1-D array of Hermite series coefficients ordered from low to high</span>
<span class="sd">        degree.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mat : ndarray</span>
<span class="sd">        Scaled companion matrix of dimensions (deg, deg).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">as_series</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Series must have maximum degree of at least 1.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">scl</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))))</span>
    <span class="n">scl</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">scl</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">shp</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span> <span class="p">::</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)))</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">n</span> <span class="p">::</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)))</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="n">scl</span> <span class="o">*</span> <span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">mat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.identity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">identity</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Identity matrix.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identity matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">identity</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identity matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Identity matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.identity_like" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">identity_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Identity matrix with the same shape as A.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identity matrix with the same shape as A.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">identity_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identity matrix with the same shape as A.</span>

<span class="sd">    Args:</span>
<span class="sd">        A: Matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Identity matrix with the same shape as A.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">space_dims</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">space_dims</span>
    <span class="n">total_dim</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">space_dims</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">total_dim</span><span class="p">,</span> <span class="n">total_dim</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="n">space_dims</span><span class="p">,</span> <span class="n">space_dims</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.inductance_to_inductive_energy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inductance_to_inductive_energy</span><span class="p">(</span><span class="n">L</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert inductance to inductive energy E_L.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>L</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Inductance in nH.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Inductive energy in GHz.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/units.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inductance_to_inductive_energy</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert inductance to inductive energy E_L.</span>

<span class="sd">    Args:</span>
<span class="sd">        L (float): Inductance in nH.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Inductive energy in GHz.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">inv_L</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">/</span> <span class="n">L</span>
    <span class="n">El_joules</span> <span class="o">=</span> <span class="n">inv_L</span> <span class="o">*</span> <span class="p">(</span><span class="n">FLUX_QUANTUM</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">joule_to_GHz</span><span class="p">(</span><span class="n">El_joules</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.inductive_energy_to_inductance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inductive_energy_to_inductance</span><span class="p">(</span><span class="n">El</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert inductive energy E_L to inductance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>El</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>inductive energy in GHz.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Inductance in nH.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/units.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inductive_energy_to_inductance</span><span class="p">(</span><span class="n">El</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert inductive energy E_L to inductance.</span>

<span class="sd">    Args:</span>
<span class="sd">        El (float): inductive energy in GHz.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Inductance in nH.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">inv_L</span> <span class="o">=</span> <span class="n">GHz_to_joule</span><span class="p">(</span><span class="n">El</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLUX_QUANTUM</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">1e9</span> <span class="o">/</span> <span class="n">inv_L</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.inv_pF_to_Ec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inv_pF_to_Ec</span><span class="p">(</span><span class="n">inv_pfarad</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>1/picoFarad -&gt; GHz</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/units.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inv_pF_to_Ec</span><span class="p">(</span><span class="n">inv_pfarad</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1/picoFarad -&gt; GHz</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inv_nFarad</span> <span class="o">=</span> <span class="n">inv_pfarad</span> <span class="o">*</span> <span class="mf">1e3</span>
    <span class="n">Gjoule</span> <span class="o">=</span> <span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">e</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">inv_nFarad</span>
    <span class="k">return</span> <span class="n">joule_to_GHz</span><span class="p">(</span><span class="n">Gjoule</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.is_dm_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dm_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check if data is a density matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    True if data is a density matrix</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_dm_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if data is a density matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: matrix</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if data is a density matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.jnp2jqt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jnp2jqt</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>JAX array -&gt; QuTiP state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>jnp_obj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JAX array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="jaxquantum.core.dims.DIMS_TYPE">DIMS_TYPE</span>, <span title="typing.List">List</span>[<span title="int">int</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray dims.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>QuTiP state.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/conversions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">jnp2jqt</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">dims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">DIMS_TYPE</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;JAX array -&gt; QuTiP state.</span>

<span class="sd">    Args:</span>
<span class="sd">        jnp_obj: JAX array.</span>
<span class="sd">        dims: Qarray dims.</span>

<span class="sd">    Returns:</span>
<span class="sd">        QuTiP state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">extract_dims</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="k">if</span> <span class="n">dims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.jqt2qt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jqt2qt</span><span class="p">(</span><span class="n">jqt_obj</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Qarray -&gt; QuTiP state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>jqt_obj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>QuTiP dims.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>QuTiP state.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/conversions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">jqt2qt</span><span class="p">(</span><span class="n">jqt_obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Qarray -&gt; QuTiP state.</span>

<span class="sd">    Args:</span>
<span class="sd">        jqt_obj: Qarray.</span>
<span class="sd">        dims: QuTiP dims.</span>

<span class="sd">    Returns:</span>
<span class="sd">        QuTiP state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">jqt_obj</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">)</span> <span class="ow">or</span> <span class="n">jqt_obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jqt_obj</span>

    <span class="k">if</span> <span class="n">jqt_obj</span><span class="o">.</span><span class="n">is_batched</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jqt_obj</span><span class="p">)):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jqt2qt</span><span class="p">(</span><span class="n">jqt_obj</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">jqt_obj</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">list</span><span class="p">(</span><span class="n">jqt_obj</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">jqt_obj</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.ket2dm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ket2dm</span><span class="p">(</span><span class="n">qarr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Turns ket into density matrix.
Does nothing if already operator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>qarr</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Density matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ket2dm</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Turns ket into density matrix.</span>
<span class="sd">    Does nothing if already operator.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): qarr</span>

<span class="sd">    Returns:</span>
<span class="sd">        Density matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">qarr</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">oper</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">qarr</span>

    <span class="k">if</span> <span class="n">qarr</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">bra</span><span class="p">:</span>
        <span class="n">qarr</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">qarr</span> <span class="o">@</span> <span class="n">qarr</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.mesolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solver_options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Quantum Master Equation solver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>H</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>, <span title="typing.Callable">Callable</span>[[<span title="float">float</span>], <a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time dependent Hamiltonian function or time-independent Qarray.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rho0</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial state, must be a density matrix. For statevector evolution, please use sesolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tlist</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time list</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>saveat_tlist</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of times at which to save the state.
If -1 or [-1], save only at final time.
If None, save at all times in tlist. Default: None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_ops</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>qarray list of collapse operators</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver_options</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jaxquantum.core.solvers.SolverOptions">SolverOptions</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SolverOptions with solver options</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of states</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mesolve</span><span class="p">(</span>
    <span class="n">H</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Qarray</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Qarray</span><span class="p">]],</span>
    <span class="n">rho0</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span>
    <span class="n">tlist</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">saveat_tlist</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">c_ops</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Qarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">solver_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SolverOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Quantum Master Equation solver.</span>

<span class="sd">    Args:</span>
<span class="sd">        H: time dependent Hamiltonian function or time-independent Qarray.</span>
<span class="sd">        rho0: initial state, must be a density matrix. For statevector evolution, please use sesolve.</span>
<span class="sd">        tlist: time list</span>
<span class="sd">        saveat_tlist: list of times at which to save the state.</span>
<span class="sd">            If -1 or [-1], save only at final time.</span>
<span class="sd">            If None, save at all times in tlist. Default: None.</span>
<span class="sd">        c_ops: qarray list of collapse operators</span>
<span class="sd">        solver_options: SolverOptions with solver options</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of states</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">saveat_tlist</span> <span class="o">=</span> <span class="n">saveat_tlist</span> <span class="k">if</span> <span class="n">saveat_tlist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">tlist</span>

    <span class="n">saveat_tlist</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">saveat_tlist</span><span class="p">)</span>

    <span class="n">c_ops</span> <span class="o">=</span> <span class="n">c_ops</span> <span class="k">if</span> <span class="n">c_ops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">from_list</span><span class="p">([])</span>

    <span class="c1"># if isinstance(H, Qarray):</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_ops</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">rho0</span><span class="o">.</span><span class="n">qtype</span> <span class="o">!=</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">oper</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Consider using `jqt.sesolve()` instead, as `c_ops` is an empty list and the initial state is not a density matrix.&quot;</span>
        <span class="p">)</span>

    <span class="n">Ï0</span> <span class="o">=</span> <span class="n">rho0</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">Ï0</span><span class="o">.</span><span class="n">dims</span>
    <span class="n">Ï0</span> <span class="o">=</span> <span class="n">Ï0</span><span class="o">.</span><span class="n">data</span>

    <span class="n">c_ops</span> <span class="o">=</span> <span class="n">c_ops</span><span class="o">.</span><span class="n">data</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
        <span class="n">Ht_data</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">H</span><span class="o">.</span><span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ht_data</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">H</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>

    <span class="n">ys</span> <span class="o">=</span> <span class="n">_mesolve_data</span><span class="p">(</span><span class="n">Ht_data</span><span class="p">,</span> <span class="n">Ï0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="p">,</span> <span class="n">c_ops</span><span class="p">,</span>
                       <span class="n">solver_options</span><span class="o">=</span><span class="n">solver_options</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jnp2jqt</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.multi_mode_basis_set" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multi_mode_basis_set</span><span class="p">(</span><span class="n">Ns</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a multi-mode basis set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Ns</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Hilbert space dimensions for each mode.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multi-mode basis set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multi_mode_basis_set</span><span class="p">(</span><span class="n">Ns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a multi-mode basis set.</span>

<span class="sd">    Args:</span>
<span class="sd">        Ns: List of Hilbert space dimensions for each mode.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Multi-mode basis set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="n">Ns</span><span class="p">))</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Ns</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">Ns</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">bdims</span><span class="o">=</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="n">Ns</span><span class="p">),))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.n_thermal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">n_thermal</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">temperature</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Calculate the average thermal photon number for a given frequency and temperature.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frequency</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency in GHz.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature in Kelvin.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average thermal photon number.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/units.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">n_thermal</span><span class="p">(</span><span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the average thermal photon number for a given frequency and temperature.</span>

<span class="sd">    Args:</span>
<span class="sd">        frequency (float): Frequency in GHz.</span>
<span class="sd">        temperature (float): Temperature in Kelvin.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Average thermal photon number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">k</span>  <span class="c1"># Boltzmann constant in J/K</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">h</span>  <span class="c1"># Planck constant in JÂ·s</span>

    <span class="n">exponent</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">frequency</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">temperature</span><span class="p">)</span>
    <span class="n">n_avg</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n_avg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Number operator</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert Space size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number operator in Hilber Space of size N</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">num</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number operator</span>

<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert Space size</span>

<span class="sd">    Returns:</span>
<span class="sd">        number operator in Hilber Space of size N</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.overlap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overlap</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Overlap between two states or operators.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rho</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state/operator.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sigma</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state/operator.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Overlap between rho and sigma.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/measurements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">overlap</span><span class="p">(</span><span class="n">rho</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Overlap between two states or operators.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho: state/operator.</span>
<span class="sd">        sigma: state/operator.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Overlap between rho and sigma.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">rho</span><span class="o">.</span><span class="n">is_vec</span><span class="p">()</span> <span class="ow">and</span> <span class="n">sigma</span><span class="o">.</span><span class="n">is_vec</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(((</span><span class="n">rho</span><span class="o">.</span><span class="n">to_ket</span><span class="p">()</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">@</span> <span class="n">sigma</span><span class="o">.</span><span class="n">to_ket</span><span class="p">())</span><span class="o">.</span><span class="n">trace</span><span class="p">()))</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">rho</span><span class="o">.</span><span class="n">is_vec</span><span class="p">():</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">to_ket</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">@</span> <span class="n">sigma</span> <span class="o">@</span> <span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sigma</span><span class="o">.</span><span class="n">is_vec</span><span class="p">():</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">to_ket</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigma</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">@</span> <span class="n">rho</span> <span class="o">@</span> <span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">@</span> <span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.plot_cf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_cf</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">qp_type</span><span class="o">=</span><span class="n">WIGNER</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot characteristic function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state with arbitrary number of batch dimensions, result will</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_x</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_y</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib axes to plot on</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contour</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>make the plot use contouring</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qp_type</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>type of quasi probability distribution ("wigner")</p>
              </div>
            </td>
            <td>
                  <code><span title="jaxquantum.core.visualization.WIGNER">WIGNER</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cbar_label</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>labels for the real and imaginary cbar</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axis_scale_factor</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scale of the axes labels relative</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot_cbar</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to plot cbar</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the x-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the y-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the z-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>subtitles for the subplots</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>figtitle</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>figure title</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>axis on which the plot was plotted.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_cf</span><span class="p">(</span>
        <span class="n">state</span><span class="p">,</span>
        <span class="n">pts_x</span><span class="p">,</span>
        <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">qp_type</span><span class="o">=</span><span class="n">WIGNER</span><span class="p">,</span>
        <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">plot_grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot characteristic function.</span>


<span class="sd">    Args:</span>
<span class="sd">        state: state with arbitrary number of batch dimensions, result will</span>
<span class="sd">        be flattened to a 2d grid to allow for plotting</span>
<span class="sd">        pts_x: x points to evaluate quasi-probability distribution at</span>
<span class="sd">        pts_y: y points to evaluate quasi-probability distribution at</span>
<span class="sd">        axs: matplotlib axes to plot on</span>
<span class="sd">        contour: make the plot use contouring</span>
<span class="sd">        qp_type: type of quasi probability distribution (&quot;wigner&quot;)</span>
<span class="sd">        cbar_label: labels for the real and imaginary cbar</span>
<span class="sd">        axis_scale_factor: scale of the axes labels relative</span>
<span class="sd">        plot_cbar: whether to plot cbar</span>
<span class="sd">        x_ticks: tick position for the x-axis</span>
<span class="sd">        y_ticks: tick position for the y-axis</span>
<span class="sd">        z_ticks: tick position for the z-axis</span>
<span class="sd">        subtitles: subtitles for the subplots</span>
<span class="sd">        figtitle: figure title</span>

<span class="sd">    Returns:</span>
<span class="sd">        axis on which the plot was plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pts_y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pts_y</span> <span class="o">=</span> <span class="n">pts_x</span>
    <span class="n">pts_x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pts_x</span><span class="p">)</span>
    <span class="n">pts_y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pts_y</span><span class="p">)</span>

    <span class="n">bdims</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">bdims</span>
    <span class="n">added_baxes</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">subtitles</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">bdims</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;labels must have same shape as bdims, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;got shapes </span><span class="si">{</span><span class="n">subtitles</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">bdims</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
        <span class="n">added_baxes</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">added_baxes</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">extra_dims</span> <span class="o">=</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">extra_dims</span> <span class="o">!=</span> <span class="p">():</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">reshape_bdims</span><span class="p">(</span>
            <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extra_dims</span><span class="p">))),</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subtitles</span> <span class="o">=</span> <span class="n">subtitles</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extra_dims</span><span class="p">))),</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">bdims</span>

    <span class="k">if</span> <span class="n">axs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">if</span> <span class="n">qp_type</span> <span class="o">==</span> <span class="n">WIGNER</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;seismic&quot;</span>
        <span class="n">cbar_label</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$\mathcal</span><span class="si">{Re}</span><span class="s2">(\chi_W(\alpha))$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\mathcal{&quot;</span>
                                                         <span class="sa">r</span><span class="s2">&quot;Im}(\chi_W(&quot;</span>
                                                         <span class="sa">r</span><span class="s2">&quot;\alpha))$&quot;</span><span class="p">]</span>
        <span class="n">QP</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">cf_wigner</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">added_baxes</span><span class="p">):</span>
        <span class="n">QP</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">QP</span><span class="p">])</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axs</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subtitles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">subtitles</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">added_baxes</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># When the input state is zero-dimensional, remove an</span>
                     <span class="c1"># axis that is automatically added due to the subcolumns</span>


    <span class="n">pts_x</span> <span class="o">=</span> <span class="n">pts_x</span> <span class="o">*</span> <span class="n">axis_scale_factor</span>
    <span class="n">pts_y</span> <span class="o">=</span> <span class="n">pts_y</span> <span class="o">*</span> <span class="n">axis_scale_factor</span>

    <span class="n">x_ticks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts_x</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts_x</span><span class="p">),</span>
                     <span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">x_ticks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x_ticks</span>
    <span class="p">)</span>
    <span class="n">y_ticks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts_y</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts_y</span><span class="p">),</span>
                     <span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">y_ticks</span>
    <span class="p">)</span>
    <span class="n">z_ticks</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="k">if</span> <span class="n">z_ticks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">z_ticks</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">subcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">col</span> <span class="o">+</span> <span class="n">subcol</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">contour</span><span class="p">:</span>
                    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                        <span class="n">pts_x</span><span class="p">,</span>
                        <span class="n">pts_y</span><span class="p">,</span>
                        <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">QP</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">])</span> <span class="k">if</span> <span class="n">subcol</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">jnp</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">QP</span><span class="p">[</span>
                                                                           <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]),</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                        <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">101</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                        <span class="n">pts_x</span><span class="p">,</span>
                        <span class="n">pts_y</span><span class="p">,</span>
                        <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">QP</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">])</span> <span class="k">if</span> <span class="n">subcol</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">jnp</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">QP</span><span class="p">[</span>
                                                                                <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]),</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
                <span class="c1"># ax.axhline(0, linestyle=&quot;-&quot;, color=&quot;black&quot;, alpha=0.7)</span>
                <span class="c1"># ax.axvline(0, linestyle=&quot;-&quot;, color=&quot;black&quot;, alpha=0.7)</span>

                <span class="k">if</span> <span class="n">plot_grid</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">plot_cbar</span><span class="p">:</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
                        <span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span>
                        <span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">[</span><span class="n">subcol</span><span class="p">])</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">z_ticks</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Re[$\alpha$]&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Im[$\alpha$]&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">])</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">figtitle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">figtitle</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.04</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axs</span><span class="p">,</span> <span class="n">im</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.plot_cf_wigner" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_cf_wigner</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot the Wigner characteristic function of the state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state with arbitrary number of batch dimensions, result will</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_x</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_y</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib axes to plot on</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contour</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>make the plot use contouring</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cbar_label</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>label for the cbar</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axis_scale_factor</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scale of the axes labels relative</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot_cbar</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to plot cbar</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the x-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the y-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the z-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>subtitles for the subplots</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>figtitle</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>figure title</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>axis on which the plot was plotted.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_cf_wigner</span><span class="p">(</span>
    <span class="n">state</span><span class="p">,</span>
    <span class="n">pts_x</span><span class="p">,</span>
    <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the Wigner characteristic function of the state.</span>


<span class="sd">    Args:</span>
<span class="sd">        state: state with arbitrary number of batch dimensions, result will</span>
<span class="sd">        be flattened to a 2d grid to allow for plotting</span>
<span class="sd">        pts_x: x points to evaluate quasi-probability distribution at</span>
<span class="sd">        pts_y: y points to evaluate quasi-probability distribution at</span>
<span class="sd">        axs: matplotlib axes to plot on</span>
<span class="sd">        contour: make the plot use contouring</span>
<span class="sd">        cbar_label: label for the cbar</span>
<span class="sd">        axis_scale_factor: scale of the axes labels relative</span>
<span class="sd">        plot_cbar: whether to plot cbar</span>
<span class="sd">        x_ticks: tick position for the x-axis</span>
<span class="sd">        y_ticks: tick position for the y-axis</span>
<span class="sd">        z_ticks: tick position for the z-axis</span>
<span class="sd">        subtitles: subtitles for the subplots</span>
<span class="sd">        figtitle: figure title</span>

<span class="sd">    Returns:</span>
<span class="sd">        axis on which the plot was plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">plot_cf</span><span class="p">(</span>
        <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
        <span class="n">pts_x</span><span class="o">=</span><span class="n">pts_x</span><span class="p">,</span>
        <span class="n">pts_y</span><span class="o">=</span><span class="n">pts_y</span><span class="p">,</span>
        <span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span>
        <span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span>
        <span class="n">qp_type</span><span class="o">=</span><span class="n">WIGNER</span><span class="p">,</span>
        <span class="n">cbar_label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">,</span>
        <span class="n">axis_scale_factor</span><span class="o">=</span><span class="n">axis_scale_factor</span><span class="p">,</span>
        <span class="n">plot_cbar</span><span class="o">=</span><span class="n">plot_cbar</span><span class="p">,</span>
        <span class="n">plot_grid</span><span class="o">=</span><span class="n">plot_grid</span><span class="p">,</span>
        <span class="n">x_ticks</span><span class="o">=</span><span class="n">x_ticks</span><span class="p">,</span>
        <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">z_ticks</span><span class="o">=</span><span class="n">z_ticks</span><span class="p">,</span>
        <span class="n">subtitles</span><span class="o">=</span><span class="n">subtitles</span><span class="p">,</span>
        <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.plot_qfunc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_qfunc</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot the husimi function of the state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state with arbitrary number of batch dimensions, result will</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_x</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_y</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>g </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>float, default: 2</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>related to the value of </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>math:<code>\hbar</code> in the commutation relation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code></code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>math:<code>[x,\,y] = i\hbar</code> via :math:<code>\hbar=2/g^2</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib axes to plot on</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contour</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>make the plot use contouring</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cbar_label</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>label for the cbar</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axis_scale_factor</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scale of the axes labels relative</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot_cbar</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to plot cbar</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the x-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the y-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the z-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>subtitles for the subplots</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>figtitle</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>figure title</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>axis on which the plot was plotted.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_qfunc</span><span class="p">(</span>
    <span class="n">state</span><span class="p">,</span>
    <span class="n">pts_x</span><span class="p">,</span>
    <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the husimi function of the state.</span>


<span class="sd">    Args:</span>
<span class="sd">        state: state with arbitrary number of batch dimensions, result will</span>
<span class="sd">        be flattened to a 2d grid to allow for plotting</span>
<span class="sd">        pts_x: x points to evaluate quasi-probability distribution at</span>
<span class="sd">        pts_y: y points to evaluate quasi-probability distribution at</span>
<span class="sd">        g : float, default: 2</span>
<span class="sd">        Scaling factor for ``a = 0.5 * g * (x + iy)``.  The value of `g` is</span>
<span class="sd">        related to the value of :math:`\\hbar` in the commutation relation</span>
<span class="sd">        :math:`[x,\,y] = i\\hbar` via :math:`\\hbar=2/g^2`.</span>
<span class="sd">        axs: matplotlib axes to plot on</span>
<span class="sd">        contour: make the plot use contouring</span>
<span class="sd">        cbar_label: label for the cbar</span>
<span class="sd">        axis_scale_factor: scale of the axes labels relative</span>
<span class="sd">        plot_cbar: whether to plot cbar</span>
<span class="sd">        x_ticks: tick position for the x-axis</span>
<span class="sd">        y_ticks: tick position for the y-axis</span>
<span class="sd">        z_ticks: tick position for the z-axis</span>
<span class="sd">        subtitles: subtitles for the subplots</span>
<span class="sd">        figtitle: figure title</span>

<span class="sd">    Returns:</span>
<span class="sd">        axis on which the plot was plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">plot_qp</span><span class="p">(</span>
        <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
        <span class="n">pts_x</span><span class="o">=</span><span class="n">pts_x</span><span class="p">,</span>
        <span class="n">pts_y</span><span class="o">=</span><span class="n">pts_y</span><span class="p">,</span>
        <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
        <span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span>
        <span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span>
        <span class="n">qp_type</span><span class="o">=</span><span class="n">HUSIMI</span><span class="p">,</span>
        <span class="n">cbar_label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">,</span>
        <span class="n">axis_scale_factor</span><span class="o">=</span><span class="n">axis_scale_factor</span><span class="p">,</span>
        <span class="n">plot_cbar</span><span class="o">=</span><span class="n">plot_cbar</span><span class="p">,</span>
        <span class="n">x_ticks</span><span class="o">=</span><span class="n">x_ticks</span><span class="p">,</span>
        <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">z_ticks</span><span class="o">=</span><span class="n">z_ticks</span><span class="p">,</span>
        <span class="n">subtitles</span><span class="o">=</span><span class="n">subtitles</span><span class="p">,</span>
        <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.plot_qp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_qp</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">qp_type</span><span class="o">=</span><span class="n">WIGNER</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot quasi-probability distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state with arbitrary number of batch dimensions, result will</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_x</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_y</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>g </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>float, default: 2</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>related to the value of </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>math:<code>\hbar</code> in the commutation relation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code></code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>math:<code>[x,\,y] = i\hbar</code> via :math:<code>\hbar=2/g^2</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib axes to plot on</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contour</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>make the plot use contouring</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qp_type</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>type of quasi probability distribution ("wigner", "qfunc")</p>
              </div>
            </td>
            <td>
                  <code><span title="jaxquantum.core.visualization.WIGNER">WIGNER</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cbar_label</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>label for the cbar</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axis_scale_factor</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scale of the axes labels relative</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot_cbar</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to plot cbar</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the x-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the y-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the z-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>subtitles for the subplots</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>figtitle</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>figure title</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>axis on which the plot was plotted.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_qp</span><span class="p">(</span>
    <span class="n">state</span><span class="p">,</span>
    <span class="n">pts_x</span><span class="p">,</span>
    <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">qp_type</span><span class="o">=</span><span class="n">WIGNER</span><span class="p">,</span>
    <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot quasi-probability distribution.</span>


<span class="sd">    Args:</span>
<span class="sd">        state: state with arbitrary number of batch dimensions, result will</span>
<span class="sd">        be flattened to a 2d grid to allow for plotting</span>
<span class="sd">        pts_x: x points to evaluate quasi-probability distribution at</span>
<span class="sd">        pts_y: y points to evaluate quasi-probability distribution at</span>
<span class="sd">        g : float, default: 2</span>
<span class="sd">        Scaling factor for ``a = 0.5 * g * (x + iy)``.  The value of `g` is</span>
<span class="sd">        related to the value of :math:`\\hbar` in the commutation relation</span>
<span class="sd">        :math:`[x,\,y] = i\\hbar` via :math:`\\hbar=2/g^2`.</span>
<span class="sd">        axs: matplotlib axes to plot on</span>
<span class="sd">        contour: make the plot use contouring</span>
<span class="sd">        qp_type: type of quasi probability distribution (&quot;wigner&quot;, &quot;qfunc&quot;)</span>
<span class="sd">        cbar_label: label for the cbar</span>
<span class="sd">        axis_scale_factor: scale of the axes labels relative</span>
<span class="sd">        plot_cbar: whether to plot cbar</span>
<span class="sd">        x_ticks: tick position for the x-axis</span>
<span class="sd">        y_ticks: tick position for the y-axis</span>
<span class="sd">        z_ticks: tick position for the z-axis</span>
<span class="sd">        subtitles: subtitles for the subplots</span>
<span class="sd">        figtitle: figure title</span>

<span class="sd">    Returns:</span>
<span class="sd">        axis on which the plot was plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pts_y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pts_y</span> <span class="o">=</span> <span class="n">pts_x</span>
    <span class="n">pts_x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pts_x</span><span class="p">)</span>
    <span class="n">pts_y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pts_y</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">bdims</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">state</span><span class="o">.</span><span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


    <span class="n">bdims</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">bdims</span>
    <span class="n">added_baxes</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">subtitles</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">bdims</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;labels must have same shape as bdims, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;got shapes </span><span class="si">{</span><span class="n">subtitles</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">bdims</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
        <span class="n">added_baxes</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">added_baxes</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">extra_dims</span> <span class="o">=</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">extra_dims</span> <span class="o">!=</span> <span class="p">():</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">reshape_bdims</span><span class="p">(</span>
            <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extra_dims</span><span class="p">))),</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subtitles</span> <span class="o">=</span> <span class="n">subtitles</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extra_dims</span><span class="p">))),</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">bdims</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">bdims</span>

    <span class="k">if</span> <span class="n">axs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">qp_type</span> <span class="o">==</span> <span class="n">WIGNER</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;seismic&quot;</span>
        <span class="n">cbar_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\mathcal</span><span class="si">{W}</span><span class="s2">(\alpha)$&quot;</span>
        <span class="n">QP</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">wigner</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">qp_type</span> <span class="o">==</span> <span class="n">HUSIMI</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;jet&quot;</span>
        <span class="n">cbar_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\mathcal</span><span class="si">{Q}</span><span class="s2">(\alpha)$&quot;</span>
        <span class="n">QP</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">qfunc</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>



    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">added_baxes</span><span class="p">):</span>
        <span class="n">QP</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">QP</span><span class="p">])</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axs</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subtitles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">subtitles</span><span class="p">])</span>




    <span class="n">pts_x</span> <span class="o">=</span> <span class="n">pts_x</span> <span class="o">*</span> <span class="n">axis_scale_factor</span>
    <span class="n">pts_y</span> <span class="o">=</span> <span class="n">pts_y</span> <span class="o">*</span> <span class="n">axis_scale_factor</span>

    <span class="n">x_ticks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts_x</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts_x</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">x_ticks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x_ticks</span>
    <span class="p">)</span>
    <span class="n">y_ticks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts_y</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts_y</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">y_ticks</span>
    <span class="p">)</span>
    <span class="n">z_ticks</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">if</span> <span class="n">z_ticks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">z_ticks</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">contour</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                    <span class="n">pts_x</span><span class="p">,</span>
                    <span class="n">pts_y</span><span class="p">,</span>
                    <span class="n">QP</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                    <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">101</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                    <span class="n">pts_x</span><span class="p">,</span>
                    <span class="n">pts_y</span><span class="p">,</span>
                    <span class="n">QP</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">plot_cbar</span><span class="p">:</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
                    <span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">)</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">z_ticks</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Re[$\alpha$]&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Im[$\alpha$]&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subtitles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">])</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">figtitle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">figtitle</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.04</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axs</span><span class="p">,</span> <span class="n">im</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.plot_wigner" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_wigner</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot the wigner function of the state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state with arbitrary number of batch dimensions, result will</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_x</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pts_y</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y points to evaluate quasi-probability distribution at</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>g </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>float, default: 2</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>related to the value of </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>math:<code>\hbar</code> in the commutation relation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code></code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>math:<code>[x,\,y] = i\hbar</code> via :math:<code>\hbar=2/g^2</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib axes to plot on</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contour</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>make the plot use contouring</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cbar_label</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>label for the cbar</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axis_scale_factor</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scale of the axes labels relative</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot_cbar</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to plot cbar</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the x-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the y-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z_ticks</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tick position for the z-axis</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>subtitles for the subplots</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>figtitle</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>figure title</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>axis on which the plot was plotted.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_wigner</span><span class="p">(</span>
    <span class="n">state</span><span class="p">,</span>
    <span class="n">pts_x</span><span class="p">,</span>
    <span class="n">pts_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">axis_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">plot_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">x_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">z_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">subtitles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">figtitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the wigner function of the state.</span>


<span class="sd">    Args:</span>
<span class="sd">        state: state with arbitrary number of batch dimensions, result will</span>
<span class="sd">        be flattened to a 2d grid to allow for plotting</span>
<span class="sd">        pts_x: x points to evaluate quasi-probability distribution at</span>
<span class="sd">        pts_y: y points to evaluate quasi-probability distribution at</span>
<span class="sd">        g : float, default: 2</span>
<span class="sd">        Scaling factor for ``a = 0.5 * g * (x + iy)``.  The value of `g` is</span>
<span class="sd">        related to the value of :math:`\\hbar` in the commutation relation</span>
<span class="sd">        :math:`[x,\,y] = i\\hbar` via :math:`\\hbar=2/g^2`.</span>
<span class="sd">        axs: matplotlib axes to plot on</span>
<span class="sd">        contour: make the plot use contouring</span>
<span class="sd">        cbar_label: label for the cbar</span>
<span class="sd">        axis_scale_factor: scale of the axes labels relative</span>
<span class="sd">        plot_cbar: whether to plot cbar</span>
<span class="sd">        x_ticks: tick position for the x-axis</span>
<span class="sd">        y_ticks: tick position for the y-axis</span>
<span class="sd">        z_ticks: tick position for the z-axis</span>
<span class="sd">        subtitles: subtitles for the subplots</span>
<span class="sd">        figtitle: figure title</span>

<span class="sd">    Returns:</span>
<span class="sd">        axis on which the plot was plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">plot_qp</span><span class="p">(</span>
        <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
        <span class="n">pts_x</span><span class="o">=</span><span class="n">pts_x</span><span class="p">,</span>
        <span class="n">pts_y</span><span class="o">=</span><span class="n">pts_y</span><span class="p">,</span>
        <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
        <span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span>
        <span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span>
        <span class="n">qp_type</span><span class="o">=</span><span class="n">WIGNER</span><span class="p">,</span>
        <span class="n">cbar_label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">,</span>
        <span class="n">axis_scale_factor</span><span class="o">=</span><span class="n">axis_scale_factor</span><span class="p">,</span>
        <span class="n">plot_cbar</span><span class="o">=</span><span class="n">plot_cbar</span><span class="p">,</span>
        <span class="n">x_ticks</span><span class="o">=</span><span class="n">x_ticks</span><span class="p">,</span>
        <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">z_ticks</span><span class="o">=</span><span class="n">z_ticks</span><span class="p">,</span>
        <span class="n">subtitles</span><span class="o">=</span><span class="n">subtitles</span><span class="p">,</span>
        <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.powm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">powm</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">clip_eigvals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Matrix power.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>power</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clip_eigvals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>clip eigenvalues to always be able to compute</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix power</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">powm</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">clip_eigvals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix power.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>
<span class="sd">        n (int): power</span>
<span class="sd">        clip_eigvals (bool): clip eigenvalues to always be able to compute</span>
<span class="sd">        non-integer powers</span>

<span class="sd">    Returns:</span>
<span class="sd">        matrix power</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">data_res</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">evalues</span><span class="p">,</span> <span class="n">evectors</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clip_eigvals</span><span class="p">:</span>
            <span class="n">evalues</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">evalues</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">evalues</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Non-integer power of a matrix can only be &quot;</span>
                    <span class="s2">&quot;computed if the matrix is positive semi-definite.&quot;</span>
                    <span class="s2">&quot;Got a matrix with a negative eigenvalue.&quot;</span>
                <span class="p">)</span>
        <span class="n">data_res</span> <span class="o">=</span> <span class="n">evectors</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">evalues</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">evectors</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data_res</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">qarr</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.powm_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">powm_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Matrix power.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>power</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix power</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">powm_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix power.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: matrix</span>
<span class="sd">        n: power</span>

<span class="sd">    Returns:</span>
<span class="sd">        matrix power</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.propagator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">propagator</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solver_options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate the propagator for a time dependent Hamiltonian.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>H</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a> or <span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Qarray static Hamiltonian OR
a function that takes a time argument and returns a Hamiltonian.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ts</code>
            </td>
            <td>
                  <code><span title="float">float</span> or <span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single time point or
an Array of time points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>saveat_tlist</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of times at which to save the state.
If -1 or [-1], save only at final time.
If None, save at all times in tlist. Default: None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray or List[Qarray]:
The propagator for the Hamiltonian at time t.
OR a list of propagators for the Hamiltonian at each time in t.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">propagator</span><span class="p">(</span>
    <span class="n">H</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Qarray</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Qarray</span><span class="p">]],</span>
    <span class="n">ts</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span>
    <span class="n">saveat_tlist</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">solver_options</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Generate the propagator for a time dependent Hamiltonian.</span>

<span class="sd">    Args:</span>
<span class="sd">        H (Qarray or callable):</span>
<span class="sd">            A Qarray static Hamiltonian OR</span>
<span class="sd">            a function that takes a time argument and returns a Hamiltonian.</span>
<span class="sd">        ts (float or Array):</span>
<span class="sd">            A single time point or</span>
<span class="sd">            an Array of time points.</span>
<span class="sd">        saveat_tlist: list of times at which to save the state.</span>
<span class="sd">            If -1 or [-1], save only at final time.</span>
<span class="sd">            If None, save at all times in tlist. Default: None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray or List[Qarray]:</span>
<span class="sd">            The propagator for the Hamiltonian at time t.</span>
<span class="sd">            OR a list of propagators for the Hamiltonian at each time in t.</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">ts_is_scalar</span> <span class="o">=</span> <span class="n">robust_isscalar</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
    <span class="n">H_is_qarray</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">H_is_qarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">H</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">ts_is_scalar</span><span class="p">:</span>
            <span class="n">H_first</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ts</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">identity_like</span><span class="p">(</span><span class="n">H_first</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ts</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H_first</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">basis_states</span> <span class="o">=</span> <span class="n">multi_mode_basis_set</span><span class="p">(</span><span class="n">H_first</span><span class="o">.</span><span class="n">space_dims</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">sesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">basis_states</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="o">=</span><span class="n">saveat_tlist</span><span class="p">)</span>
        <span class="n">propagators_data</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mT</span>
        <span class="n">propagators</span> <span class="o">=</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">propagators_data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">H_first</span><span class="o">.</span><span class="n">space_dims</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">propagators</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.ptrace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ptrace</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="n">indx</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Partial Trace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rho</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>density matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>indx</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index of quantum object to keep, rest will be partial traced out</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>partial traced out density matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>TODO: Fix weird tracing errors that arise with reshape</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ptrace</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">indx</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Partial Trace.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho: density matrix</span>
<span class="sd">        indx: index of quantum object to keep, rest will be partial traced out</span>

<span class="sd">    Returns:</span>
<span class="sd">        partial traced out density matrix</span>

<span class="sd">    TODO: Fix weird tracing errors that arise with reshape</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">qarr</span> <span class="o">=</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">qarr</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">shaped_data</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">dims</span>

    <span class="n">Nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">indxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">indx</span><span class="p">,</span> <span class="n">indx</span> <span class="o">+</span> <span class="n">Nq</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nq</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">indx</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">indxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="n">indxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">Nq</span><span class="p">)</span>

    <span class="n">bdims</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">bdims</span>
    <span class="n">len_bdims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdims</span><span class="p">)</span>
    <span class="n">bdims_indxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">len_bdims</span><span class="p">))</span>
    <span class="n">indxs</span> <span class="o">=</span> <span class="n">bdims_indxs</span> <span class="o">+</span> <span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">len_bdims</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indxs</span><span class="p">]</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">indxs</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nq</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">axis1</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">len_bdims</span><span class="p">,</span> <span class="n">axis2</span><span class="o">=</span><span class="mi">3</span> <span class="o">+</span> <span class="n">len_bdims</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.qfunc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">qfunc</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Husimi-Q function of a given state vector or density matrix at phase-space
points <code>0.5 * g * (xvec + i*yvec)</code>.</p>
<h4 id="jaxquantum.qfunc--parameters">Parameters</h4>
<p>state : Qarray
    A state vector or density matrix. This cannot have tensor-product
    structure.</p>
<p>xvec, yvec : array_like
    x- and y-coordinates at which to calculate the Husimi-Q function.</p>


<details class="g-" open>
  <summary>float, default: 2</summary>
  <p>Scaling factor for <code>a = 0.5 * g * (x + iy)</code>.  The value of <code>g</code> is
related to the value of :math:<code>\hbar</code> in the commutation relation
:math:<code>[x,\,y] = i\hbar</code> via :math:<code>\hbar=2/g^2</code>.</p>
</details>        <h4 id="jaxquantum.qfunc--returns">Returns</h4>
<p>jnp.ndarray
    Values representing the Husimi-Q function calculated over the specified
    range <code>[xvec, yvec]</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qp_distributions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">qfunc</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Husimi-Q function of a given state vector or density matrix at phase-space</span>
<span class="sd">    points ``0.5 * g * (xvec + i*yvec)``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    state : Qarray</span>
<span class="sd">        A state vector or density matrix. This cannot have tensor-product</span>
<span class="sd">        structure.</span>

<span class="sd">    xvec, yvec : array_like</span>
<span class="sd">        x- and y-coordinates at which to calculate the Husimi-Q function.</span>

<span class="sd">    g : float, default: 2</span>
<span class="sd">        Scaling factor for ``a = 0.5 * g * (x + iy)``.  The value of `g` is</span>
<span class="sd">        related to the value of :math:`\hbar` in the commutation relation</span>
<span class="sd">        :math:`[x,\,y] = i\hbar` via :math:`\hbar=2/g^2`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    jnp.ndarray</span>
<span class="sd">        Values representing the Husimi-Q function calculated over the specified</span>
<span class="sd">        range ``[xvec, yvec]``.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">alpha_grid</span><span class="p">,</span> <span class="n">prefactor</span> <span class="o">=</span> <span class="n">_qfunc_coherent_grid</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">psi</span><span class="o">.</span><span class="n">is_vec</span><span class="p">():</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">to_ket</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_compute_qfunc</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">alpha_grid</span><span class="p">,</span> <span class="n">prefactor</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">_qfunc_iterative_single</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">alpha_grid</span><span class="p">,</span> <span class="n">prefactor</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">/=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span>
            <span class="k">return</span> <span class="n">out</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_compute_qfunc</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">alpha_grid</span><span class="p">,</span> <span class="n">prefactor</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="n">vectors</span><span class="o">.</span><span class="n">T</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_qfunc_iterative_single</span><span class="p">(</span>
                <span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha_grid</span><span class="p">,</span> <span class="n">prefactor</span><span class="p">,</span> <span class="n">g</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">vector</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">_qfunc_iterative_single</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">alpha_grid</span><span class="p">,</span> <span class="n">prefactor</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">/=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span>

            <span class="k">return</span> <span class="n">out</span>

    <span class="n">psi</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">data</span>

    <span class="n">vmapped_compute_qfunc</span> <span class="o">=</span> <span class="p">[</span><span class="n">_compute_qfunc</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">psi</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">vmapped_compute_qfunc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">vmap</span><span class="p">(</span>
                <span class="n">vmapped_compute_qfunc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="n">out_axes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">vmapped_compute_qfunc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">](</span><span class="n">psi</span><span class="p">,</span> <span class="n">alpha_grid</span><span class="p">,</span> <span class="n">prefactor</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.qt2jqt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">qt2jqt</span><span class="p">(</span><span class="n">qt_obj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>QuTiP state -&gt; Qarray.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qt_obj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>QuTiP state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JAX dtype.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.complex128">complex128</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/conversions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">qt2jqt</span><span class="p">(</span><span class="n">qt_obj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex128</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;QuTiP state -&gt; Qarray.</span>

<span class="sd">    Args:</span>
<span class="sd">        qt_obj: QuTiP state.</span>
<span class="sd">        dtype: JAX dtype.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qt_obj</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">)</span> <span class="ow">or</span> <span class="n">qt_obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">qt_obj</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qt_obj</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">qt_obj</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.qubit_rotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">qubit_rotation</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Single qubit rotation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>theta</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rotation angle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nx</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rotation axis x component.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ny</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rotation axis y component.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nz</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rotation axis z component.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single qubit rotation operator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">qubit_rotation</span><span class="p">(</span><span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Single qubit rotation.</span>

<span class="sd">    Args:</span>
<span class="sd">        theta: rotation angle.</span>
<span class="sd">        nx: rotation axis x component.</span>
<span class="sd">        ny: rotation axis y component.</span>
<span class="sd">        nz: rotation axis z component.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Single qubit rotation operator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">nx</span> <span class="o">*</span> <span class="n">sigmax</span><span class="p">()</span> <span class="o">+</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">sigmay</span><span class="p">()</span> <span class="o">+</span> <span class="n">nz</span> <span class="o">*</span> <span class="n">sigmaz</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.sesolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solver_options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>SchrÃ¶dinger Equation solver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>H</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>, <span title="typing.Callable">Callable</span>[[<span title="float">float</span>], <a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time dependent Hamiltonian function or time-independent Qarray.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rho0</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial state, must be a density matrix. For statevector evolution, please use sesolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tlist</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time list</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>saveat_tlist</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of times at which to save the state.
If -1 or [-1], save only at final time.
If None, save at all times in tlist. Default: None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver_options</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jaxquantum.core.solvers.SolverOptions">SolverOptions</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SolverOptions with solver options</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of states</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sesolve</span><span class="p">(</span>
    <span class="n">H</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Qarray</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Qarray</span><span class="p">]],</span>
    <span class="n">rho0</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span>
    <span class="n">tlist</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">saveat_tlist</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">solver_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SolverOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;SchrÃ¶dinger Equation solver.</span>

<span class="sd">    Args:</span>
<span class="sd">        H: time dependent Hamiltonian function or time-independent Qarray.</span>
<span class="sd">        rho0: initial state, must be a density matrix. For statevector evolution, please use sesolve.</span>
<span class="sd">        tlist: time list</span>
<span class="sd">        saveat_tlist: list of times at which to save the state.</span>
<span class="sd">            If -1 or [-1], save only at final time.</span>
<span class="sd">            If None, save at all times in tlist. Default: None.</span>
<span class="sd">        solver_options: SolverOptions with solver options</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of states</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">saveat_tlist</span> <span class="o">=</span> <span class="n">saveat_tlist</span> <span class="k">if</span> <span class="n">saveat_tlist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">tlist</span>

    <span class="n">saveat_tlist</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">saveat_tlist</span><span class="p">)</span>

    <span class="n">Ïˆ</span> <span class="o">=</span> <span class="n">rho0</span>

    <span class="k">if</span> <span class="n">Ïˆ</span><span class="o">.</span><span class="n">qtype</span> <span class="o">==</span> <span class="n">Qtypes</span><span class="o">.</span><span class="n">oper</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Please use `jqt.mesolve` for initial state inputs in density matrix form.&quot;</span>
        <span class="p">)</span>

    <span class="n">Ïˆ</span> <span class="o">=</span> <span class="n">Ïˆ</span><span class="o">.</span><span class="n">to_ket</span><span class="p">()</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">Ïˆ</span><span class="o">.</span><span class="n">dims</span>
    <span class="n">Ïˆ</span> <span class="o">=</span> <span class="n">Ïˆ</span><span class="o">.</span><span class="n">data</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">Qarray</span><span class="p">):</span>
        <span class="n">Ht_data</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">H</span><span class="o">.</span><span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ht_data</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">H</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>

    <span class="n">ys</span> <span class="o">=</span> <span class="n">_sesolve_data</span><span class="p">(</span><span class="n">Ht_data</span><span class="p">,</span> <span class="n">Ïˆ</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="p">,</span>
                       <span class="n">solver_options</span><span class="o">=</span><span class="n">solver_options</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jnp2jqt</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.set_precision" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_precision</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Set the precision of JAX operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;single&#39;, &#39;double&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'single' or 'double'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if precision is not 'single' or 'double'</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/utils/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_precision</span><span class="p">(</span><span class="n">precision</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;single&quot;</span><span class="p">,</span> <span class="s2">&quot;double&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the precision of JAX operations.</span>

<span class="sd">    Args:</span>
<span class="sd">        precision: &#39;single&#39; or &#39;double&#39;</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if precision is not &#39;single&#39; or &#39;double&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">precision</span> <span class="o">==</span> <span class="s2">&quot;single&quot;</span><span class="p">:</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">precision</span> <span class="o">==</span> <span class="s2">&quot;double&quot;</span><span class="p">:</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;precision must be &#39;single&#39; or &#39;double&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.sigmam" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sigmam</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Ïƒ-</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ïƒ- Pauli Operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sigmam</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ïƒ-</span>

<span class="sd">    Returns:</span>
<span class="sd">        Ïƒ- Pauli Operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.sigmap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sigmap</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Ïƒ+</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ïƒ+ Pauli Operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sigmap</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ïƒ+</span>

<span class="sd">    Returns:</span>
<span class="sd">        Ïƒ+ Pauli Operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.sigmax" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sigmax</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Ïƒx</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ïƒx Pauli Operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sigmax</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ïƒx</span>

<span class="sd">    Returns:</span>
<span class="sd">        Ïƒx Pauli Operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.sigmay" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sigmay</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Ïƒy</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ïƒy Pauli Operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sigmay</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ïƒy</span>

<span class="sd">    Returns:</span>
<span class="sd">        Ïƒy Pauli Operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.sigmaz" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sigmaz</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Ïƒz</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ïƒz Pauli Operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sigmaz</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ïƒz</span>

<span class="sd">    Returns:</span>
<span class="sd">        Ïƒz Pauli Operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.sinm_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sinm_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Matrix sine wrapper.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matrix sine</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sinm_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix sine wrapper.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        matrix sine</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">expm_data</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">expm_data</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="n">j</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.solve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Ï0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">solver_options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gets teh desired solver from diffrax.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>function defining the ODE</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Ï0</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tlist</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time list</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>saveat_tlist</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of times at which to save the state
pass in [-1] to save only at final time</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>additional arguments to f</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver_options</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jaxquantum.core.solvers.SolverOptions">SolverOptions</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with solver options</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>solution</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Ï0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">saveat_tlist</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">solver_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
    <span class="n">SolverOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets teh desired solver from diffrax.</span>

<span class="sd">    Args:</span>
<span class="sd">        f: function defining the ODE</span>
<span class="sd">        Ï0: initial state</span>
<span class="sd">        tlist: time list</span>
<span class="sd">        saveat_tlist: list of times at which to save the state</span>
<span class="sd">            pass in [-1] to save only at final time</span>
<span class="sd">        args: additional arguments to f</span>
<span class="sd">        solver_options: dictionary with solver options</span>

<span class="sd">    Returns:</span>
<span class="sd">        solution</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># f and ts</span>
    <span class="n">term</span> <span class="o">=</span> <span class="n">ODETerm</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">saveat_tlist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">saveat_tlist</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">saveat</span> <span class="o">=</span> <span class="n">SaveAt</span><span class="p">(</span><span class="n">t1</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">saveat</span> <span class="o">=</span> <span class="n">SaveAt</span><span class="p">(</span><span class="n">ts</span><span class="o">=</span><span class="n">saveat_tlist</span><span class="p">)</span>

    <span class="c1"># solver</span>
    <span class="n">solver_options</span> <span class="o">=</span> <span class="n">solver_options</span> <span class="ow">or</span> <span class="n">SolverOptions</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

    <span class="n">solver_name</span> <span class="o">=</span> <span class="n">solver_options</span><span class="o">.</span><span class="n">solver</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">diffrax</span><span class="p">,</span> <span class="n">solver_name</span><span class="p">)()</span>
    <span class="n">stepsize_controller</span> <span class="o">=</span> <span class="n">PIDController</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="n">solver_options</span><span class="o">.</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">solver_options</span><span class="o">.</span><span class="n">atol</span><span class="p">)</span>

    <span class="c1"># solve!</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
                                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Complex dtype support in Diffrax&quot;</span><span class="p">,</span>
                                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>  <span class="c1"># NOTE: suppresses complex dtype warning in diffrax</span>
        <span class="n">sol</span> <span class="o">=</span> <span class="n">diffeqsolve</span><span class="p">(</span>
            <span class="n">term</span><span class="p">,</span>
            <span class="n">solver</span><span class="p">,</span>
            <span class="n">t0</span><span class="o">=</span><span class="n">tlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">t1</span><span class="o">=</span><span class="n">tlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">dt0</span><span class="o">=</span><span class="n">tlist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y0</span><span class="o">=</span><span class="n">Ï0</span><span class="p">,</span>
            <span class="n">saveat</span><span class="o">=</span><span class="n">saveat</span><span class="p">,</span>
            <span class="n">stepsize_controller</span><span class="o">=</span><span class="n">stepsize_controller</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
            <span class="n">max_steps</span><span class="o">=</span><span class="n">solver_options</span><span class="o">.</span><span class="n">max_steps</span><span class="p">,</span>
            <span class="n">progress_meter</span><span class="o">=</span><span class="n">CustomProgressMeter</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">solver_options</span><span class="o">.</span><span class="n">progress_meter</span>
            <span class="k">else</span> <span class="n">NoProgressMeter</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">sol</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.squeeze" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">squeeze</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Single-mode Squeezing operator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert Space Size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>squeezing parameter</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sqeezing operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">squeeze</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Single-mode Squeezing operator.</span>


<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert Space Size</span>
<span class="sd">        z: squeezing parameter</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sqeezing operator</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">op</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">@</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.tensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tensor</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Tensor product.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tensors to take the product of</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parallel</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, use parallel einsum for tensor product
true: [A,B] ^ [C,D] = [A^C, B^D]
false (default): [A,B] ^ [C,D] = [A^C, A^D, B^C, B^D]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor product of given tensors</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tensor</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tensor product.</span>

<span class="sd">    Args:</span>
<span class="sd">        *args (Qarray): tensors to take the product of</span>
<span class="sd">        parallel (bool): if True, use parallel einsum for tensor product</span>
<span class="sd">            true: [A,B] ^ [C,D] = [A^C, B^D]</span>
<span class="sd">            false (default): [A,B] ^ [C,D] = [A^C, A^D, B^C, B^D]</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor product of given tensors</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">parallel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;parallel&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">dims_0</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dims_1</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">data</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                <span class="n">batch_dim</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">prod</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">prod</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]):</span>
                    <span class="n">batch_dim</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">batch_dim</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">batch_dim</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;...ij,...kl-&gt;...ikjl&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="o">*</span><span class="n">batch_dim</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">arg</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">dims_0</span> <span class="o">=</span> <span class="n">dims_0</span> <span class="o">+</span> <span class="n">arg</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dims_1</span> <span class="o">=</span> <span class="n">dims_1</span> <span class="o">+</span> <span class="n">arg</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="n">dims_0</span><span class="p">,</span> <span class="n">dims_1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.tensor_basis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tensor_basis</span><span class="p">(</span><span class="n">single_basis</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Construct n-fold tensor product basis from a single-system basis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>single_basis</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The single-system operator basis as a Qarray.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of tensor copies to construct.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qarray containing the n-fold tensor product basis operators.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The resulting basis has b^n elements where b is the number</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of operators in the single-system basis.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/measurements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tensor_basis</span><span class="p">(</span><span class="n">single_basis</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct n-fold tensor product basis from a single-system basis.</span>

<span class="sd">    Args:</span>
<span class="sd">        single_basis: The single-system operator basis as a Qarray.</span>
<span class="sd">        n: Number of tensor copies to construct.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Qarray containing the n-fold tensor product basis operators.</span>
<span class="sd">        The resulting basis has b^n elements where b is the number</span>
<span class="sd">        of operators in the single-system basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dims</span> <span class="o">=</span> <span class="n">single_basis</span><span class="o">.</span><span class="n">dims</span>

    <span class="n">single_basis</span> <span class="o">=</span> <span class="n">single_basis</span><span class="o">.</span><span class="n">data</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">single_basis</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">b</span><span class="p">)]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s2">&quot;ij&quot;</span><span class="p">),</span>
                        <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># shape (b^n, n)</span>

    <span class="c1"># Select the operators based on indices: shape (b^n, n, d, d)</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="n">single_basis</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>  <span class="c1"># shape: (b^n, n, d, d)</span>

    <span class="c1"># Vectorized Kronecker products</span>
    <span class="n">full_basis</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">ops</span><span class="p">:</span> <span class="n">reduce</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">kron</span><span class="p">,</span> <span class="n">ops</span><span class="p">))(</span><span class="n">selected</span><span class="p">)</span>

    <span class="n">new_dims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">full_basis</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">new_dims</span><span class="p">,</span> <span class="n">bdims</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="n">n</span><span class="p">,))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.thermal_dm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">thermal_dm</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Thermal state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hilbert Space Size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>average photon number.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="return" open>
  <summary>Return</summary>
  <p>Thermal state.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/operators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">thermal_dm</span><span class="p">(</span><span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Thermal state.</span>

<span class="sd">    Args:</span>
<span class="sd">        N: Hilbert Space Size.</span>
<span class="sd">        n: average photon number.</span>

<span class="sd">    Return:</span>
<span class="sd">        Thermal state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">isposinf</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span>
            <span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">))),</span>
        <span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.tr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tr</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Full trace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Full trace.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tr</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Full trace.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>

<span class="sd">    Returns:</span>
<span class="sd">        Full trace.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">axis1</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;axis1&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axis2</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;axis2&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axis1</span><span class="o">=</span><span class="n">axis1</span><span class="p">,</span> <span class="n">axis2</span><span class="o">=</span><span class="n">axis2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.trace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trace</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Full trace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Full trace.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trace</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Full trace.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>

<span class="sd">    Returns:</span>
<span class="sd">        Full trace.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tr</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.transpose" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transpose</span><span class="p">(</span><span class="n">qarr</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Transpose the quantum array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>axes to transpose</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tranposed Qarray</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transpose</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transpose the quantum array.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>
<span class="sd">        *args: axes to transpose</span>

<span class="sd">    Returns:</span>
<span class="sd">        tranposed Qarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

    <span class="n">shaped_data</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">shaped_data</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">qarr</span><span class="o">.</span><span class="n">dims</span>
    <span class="n">bdims_indxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qarr</span><span class="o">.</span><span class="n">bdims</span><span class="p">)))</span>

    <span class="n">reshape_indices</span> <span class="o">=</span> <span class="n">indices</span> <span class="o">+</span> <span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>

    <span class="n">reshape_indices</span> <span class="o">=</span> <span class="n">bdims_indxs</span> <span class="o">+</span> <span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdims_indxs</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">reshape_indices</span><span class="p">]</span>

    <span class="n">shaped_data</span> <span class="o">=</span> <span class="n">shaped_data</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">reshape_indices</span><span class="p">)</span>
    <span class="n">new_dims</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">tuple</span><span class="p">([</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]),</span>
        <span class="nb">tuple</span><span class="p">([</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]),</span>
    <span class="p">)</span>

    <span class="n">full_dims</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">full_data</span> <span class="o">=</span> <span class="n">shaped_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">qarr</span><span class="o">.</span><span class="n">bdims</span><span class="p">,</span> <span class="n">full_dims</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Qarray</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">full_data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">new_dims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.unit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unit</span><span class="p">(</span><span class="n">qarr</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Normalize the quantum array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qarr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>quantum array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Qarray (jaxquantum.core.qarray.Qarray)" href="core/qarray.html#jaxquantum.core.qarray.Qarray">Qarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Normalized quantum array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qarray.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unit</span><span class="p">(</span><span class="n">qarr</span><span class="p">:</span> <span class="n">Qarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Qarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalize the quantum array.</span>

<span class="sd">    Args:</span>
<span class="sd">        qarr (Qarray): quantum array</span>

<span class="sd">    Returns:</span>
<span class="sd">        Normalized quantum array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">qarr</span> <span class="o">/</span> <span class="n">qarr</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jaxquantum.wigner" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wigner</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;clenshaw&#39;</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Wigner function for a state vector or density matrix at points
<code>xvec + i * yvec</code>.</p>
<h4 id="jaxquantum.wigner--parameters">Parameters</h4>


<details class="state-" open>
  <summary>Qarray</summary>
  <p>A state vector or density matrix.</p>
</details>

<details class="xvec-" open>
  <summary>array_like</summary>
  <p>x-coordinates at which to calculate the Wigner function.</p>
</details>

<details class="yvec-" open>
  <summary>array_like</summary>
  <p>y-coordinates at which to calculate the Wigner function.</p>
</details>

<details class="g-" open>
  <summary>float, default: 2</summary>
  <p>Scaling factor for <code>a = 0.5 * g * (x + iy)</code>, default <code>g = 2</code>.
The value of <code>g</code> is related to the value of <code>hbar</code> in the commutation
relation <code>[x, y] = i * hbar</code> via <code>hbar=2/g^2</code>.</p>
</details>

<details class="method-" open>
  <summary>string {'clenshaw', 'iterative', 'laguerre', 'fft'}, default: 'clenshaw'</summary>
  <p>Only 'clenshaw' is currently supported.
Select method 'clenshaw' 'iterative', 'laguerre', or 'fft', where 'clenshaw'
and 'iterative' use an iterative method to evaluate the Wigner functions for density
matrices :math:<code>|m&gt;&lt;n|</code>, while 'laguerre' uses the Laguerre polynomials
in scipy for the same task. The 'fft' method evaluates the Fourier
transform of the density matrix. The 'iterative' method is default, and
in general recommended, but the 'laguerre' method is more efficient for
very sparse density matrices (e.g., superpositions of Fock states in a
large Hilbert space). The 'clenshaw' method is the preferred method for
dealing with density matrices that have a large number of excitations
(&gt;~50). 'clenshaw' is a fast and numerically stable method.</p>
</details>        <h4 id="jaxquantum.wigner--returns">Returns</h4>


<details class="w-" open>
  <summary>array</summary>
  <p>Values representing the Wigner function calculated over the specified
range [xvec,yvec].</p>
</details>        <h4 id="jaxquantum.wigner--references">References</h4>
<p>Ulf Leonhardt,
Measuring the Quantum State of Light, (Cambridge University Press, 1997)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>jaxquantum/core/qp_distributions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wigner</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;clenshaw&quot;</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wigner function for a state vector or density matrix at points</span>
<span class="sd">    `xvec + i * yvec`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    state : Qarray</span>
<span class="sd">        A state vector or density matrix.</span>

<span class="sd">    xvec : array_like</span>
<span class="sd">        x-coordinates at which to calculate the Wigner function.</span>

<span class="sd">    yvec : array_like</span>
<span class="sd">        y-coordinates at which to calculate the Wigner function.</span>

<span class="sd">    g : float, default: 2</span>
<span class="sd">        Scaling factor for `a = 0.5 * g * (x + iy)`, default `g = 2`.</span>
<span class="sd">        The value of `g` is related to the value of `hbar` in the commutation</span>
<span class="sd">        relation `[x, y] = i * hbar` via `hbar=2/g^2`.</span>

<span class="sd">    method : string {&#39;clenshaw&#39;, &#39;iterative&#39;, &#39;laguerre&#39;, &#39;fft&#39;}, default: &#39;clenshaw&#39;</span>
<span class="sd">        Only &#39;clenshaw&#39; is currently supported.</span>
<span class="sd">        Select method &#39;clenshaw&#39; &#39;iterative&#39;, &#39;laguerre&#39;, or &#39;fft&#39;, where &#39;clenshaw&#39;</span>
<span class="sd">        and &#39;iterative&#39; use an iterative method to evaluate the Wigner functions for density</span>
<span class="sd">        matrices :math:`|m&gt;&lt;n|`, while &#39;laguerre&#39; uses the Laguerre polynomials</span>
<span class="sd">        in scipy for the same task. The &#39;fft&#39; method evaluates the Fourier</span>
<span class="sd">        transform of the density matrix. The &#39;iterative&#39; method is default, and</span>
<span class="sd">        in general recommended, but the &#39;laguerre&#39; method is more efficient for</span>
<span class="sd">        very sparse density matrices (e.g., superpositions of Fock states in a</span>
<span class="sd">        large Hilbert space). The &#39;clenshaw&#39; method is the preferred method for</span>
<span class="sd">        dealing with density matrices that have a large number of excitations</span>
<span class="sd">        (&gt;~50). &#39;clenshaw&#39; is a fast and numerically stable method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    W : array</span>
<span class="sd">        Values representing the Wigner function calculated over the specified</span>
<span class="sd">        range [xvec,yvec].</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    Ulf Leonhardt,</span>
<span class="sd">    Measuring the Quantum State of Light, (Cambridge University Press, 1997)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">is_vec</span><span class="p">()</span> <span class="ow">or</span> <span class="n">psi</span><span class="o">.</span><span class="n">is_dm</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input state is not a valid operator.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;fft&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only the &#39;clenshaw&#39; method is implemented.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;iterative&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only the &#39;clenshaw&#39; method is implemented.&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;laguerre&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only the &#39;clenshaw&#39; method is implemented.&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;clenshaw&quot;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">to_dm</span><span class="p">()</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">data</span>

        <span class="n">vmapped_wigner_clenshaw</span> <span class="o">=</span> <span class="p">[</span><span class="n">_wigner_clenshaw</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">vmapped_wigner_clenshaw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">vmap</span><span class="p">(</span>
                    <span class="n">vmapped_wigner_clenshaw</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">out_axes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">vmapped_wigner_clenshaw</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">](</span><span class="n">rho</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;method must be either &#39;iterative&#39;, &#39;laguerre&#39;, or &#39;fft&#39;.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy Copyright 2022-2025, JAXquantum developers.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/EQuS/jaxquantum" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../js/mathjax-config.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>